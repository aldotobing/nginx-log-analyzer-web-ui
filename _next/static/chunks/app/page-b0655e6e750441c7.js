(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3603:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>e_});var r=a(5696),s=a(6060),l=a(562),i=a(3956),n=a(3248),o=a(5447),d=a(7685),c=a(1387),x=a(5460),g=a(770),m=a(3634);function u(e){let{data:t={totalRequests:0,uniqueIPs:0,totalAttackAttempts:0,avgRequestsPerHour:0,peakHour:"N/A",securityScore:0,suspiciousIps:0,bandwidthUsage:0},className:a=""}=e,n=(0,s.useRef)((0,o.z)(t.totalRequests,{damping:25,stiffness:100,mass:1.2})).current,u=(0,s.useRef)((0,o.z)(t.uniqueIPs,{damping:25,stiffness:100,mass:1.2})).current,h=(0,s.useRef)((0,o.z)(t.totalAttackAttempts,{damping:25,stiffness:100,mass:1.2})).current,p=(0,s.useRef)((0,o.z)(t.suspiciousIps||0,{damping:25,stiffness:100,mass:1.2})).current;(0,s.useEffect)(()=>{n.set(t.totalRequests),u.set(t.uniqueIPs),h.set(t.totalAttackAttempts),p.set(t.suspiciousIps||0)},[t,n,u,h,p]);let b=(0,d.G)(n,e=>Math.round(e).toLocaleString()),y=(0,d.G)(u,e=>Math.round(e).toLocaleString()),f=(0,d.G)(h,e=>Math.round(e).toLocaleString()),v=(0,d.G)(p,e=>Math.round(e).toLocaleString()),j=(0,s.useMemo)(()=>{let e=t.totalRequests>0?t.totalAttackAttempts/t.totalRequests*100:0;return{attackRate:Math.round(100*e)/100,avgRequestsPerIP:t.uniqueIPs>0?Math.round(t.totalRequests/t.uniqueIPs):0,securityLevel:e<1?"High":e<5?"Medium":"Low",securityColor:e<1?"green":e<5?"yellow":"red",hasData:t.totalRequests>0}},[t]),N={hidden:{opacity:0,scale:.85,rotateX:-15,rotateY:-15,rotateZ:-5},visible:{opacity:1,scale:1,rotateX:0,rotateY:0,rotateZ:0,transition:{type:"spring",stiffness:200,damping:18,mass:.8,duration:.7}},hover:{y:-8,rotateZ:2,transition:{type:"spring",stiffness:400,damping:15}}},k=[{title:"Total Requests",value:t.totalRequests,display:b,icon:i.A,color:"blue",bgGradient:"from-blue-500/10 to-blue-600/10",borderColor:"border-blue-200 dark:border-blue-800/50",textColor:"text-blue-700 dark:text-blue-300",iconColor:"text-blue-500",description:"All HTTP requests processed"},{title:"Unique Visitors",value:t.uniqueIPs,display:y,icon:c.A,color:"green",bgGradient:"from-green-500/10 to-green-600/10",borderColor:"border-green-200 dark:border-green-800/50",textColor:"text-green-700 dark:text-green-300",iconColor:"text-green-500",description:"Avg ".concat(j.avgRequestsPerIP," requests per IP")},{title:"Security Events",value:t.totalAttackAttempts,display:f,icon:x.A,color:"red",bgGradient:"from-red-500/10 to-red-600/10",borderColor:"border-red-200 dark:border-red-800/50",textColor:"text-red-700 dark:text-red-300",iconColor:"text-red-500",description:"".concat(j.attackRate,"% of total traffic")},{title:"Suspicious IPs",value:t.suspiciousIps||0,display:v,icon:g.A,color:"orange",bgGradient:"from-orange-500/10 to-orange-600/10",borderColor:"border-orange-200 dark:border-orange-800/50",textColor:"text-orange-700 dark:text-orange-300",iconColor:"text-orange-500",description:"IPs flagged for suspicious activity"}];return j.hasData?(0,r.jsxs)(l.P.div,{variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.12,delayChildren:.15}}},initial:"hidden",animate:"visible",className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm rounded-2xl border border-gray-200/50 dark:border-gray-700/50 shadow-lg ".concat(a),children:[(0,r.jsx)("div",{className:"p-6 pb-4 border-b border-gray-200/50 dark:border-gray-700/50",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(l.P.h2,{className:"text-2xl font-bold text-gray-900 dark:text-white",initial:{opacity:0,x:-20,rotateX:-10},animate:{opacity:1,x:0,rotateX:0},transition:{type:"spring",stiffness:150,damping:15,duration:.7},children:"Request Overview"}),(0,r.jsx)(l.P.p,{className:"text-gray-600 dark:text-gray-400 mt-1",initial:{opacity:0,x:-20,rotateX:-10},animate:{opacity:1,x:0,rotateX:0},transition:{type:"spring",stiffness:150,damping:15,duration:.7,delay:.05},children:"Key metrics from your server logs"})]}),(0,r.jsxs)(l.P.div,{initial:{opacity:0,scale:.7,rotateY:-20,rotateX:-10},animate:{opacity:1,scale:1,rotateY:0,rotateX:0},transition:{type:"spring",stiffness:250,damping:20,mass:.8,duration:.6,delay:.3},whileHover:{scale:1.08,rotateZ:3,transition:{duration:.2}},className:"flex items-center space-x-2 px-3 py-1 rounded-full text-sm font-medium ".concat("green"===j.securityColor?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":"yellow"===j.securityColor?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300"),children:["green"===j.securityColor?(0,r.jsx)(x.A,{className:"h-4 w-4"}):(0,r.jsx)(g.A,{className:"h-4 w-4"}),(0,r.jsxs)("span",{children:["Security: ",j.securityLevel]})]})]})}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:k.map((e,t)=>{let a=e.icon;return(0,r.jsxs)(l.P.div,{variants:N,whileHover:{scale:1.02,transition:{duration:.2}},className:"relative overflow-hidden bg-gradient-to-br ".concat(e.bgGradient," rounded-xl border ").concat(e.borderColor," p-4 hover:shadow-lg transition-all duration-300"),children:[(0,r.jsx)("div",{className:"absolute top-1 right-1 opacity-5",children:(0,r.jsx)(a,{className:"h-16 w-16"})}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,r.jsx)("div",{className:"p-1.5 rounded-lg bg-white/50 dark:bg-gray-800/50",children:(0,r.jsx)(a,{className:"h-4 w-4 ".concat(e.iconColor)})})}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("h3",{className:"text-xs font-semibold ".concat(e.textColor," uppercase tracking-wide"),children:e.title}),(0,r.jsx)("div",{className:e.textColor,children:(0,r.jsx)(l.P.span,{className:"text-3xl lg:text-4xl font-bold tracking-tight",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{type:"spring",damping:20,stiffness:100,mass:1.2},children:e.display})}),(0,r.jsx)("p",{className:"text-[10px] text-gray-600 dark:text-gray-400 leading-tight",children:e.description})]})]}),(0,r.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gray-200 dark:bg-gray-700",children:(0,r.jsx)(l.P.div,{className:"h-full bg-gradient-to-r ".concat("blue"===e.color?"from-blue-400 to-blue-600":"green"===e.color?"from-green-400 to-green-600":"red"===e.color?"from-red-400 to-red-600":"from-orange-400 to-orange-600"),initial:{width:0},animate:{width:"100%"},transition:{type:"spring",stiffness:50,damping:15,duration:1.5,delay:.5+.1*t}})})]},e.title)})}),(t.avgRequestsPerHour||t.peakHour)&&(0,r.jsx)(l.P.div,{initial:{opacity:0,scale:.95,rotateX:-10},animate:{opacity:1,scale:1,rotateX:0},transition:{type:"spring",stiffness:150,damping:18,mass:.9,duration:.7,delay:.8},whileHover:{y:-5,rotateZ:2,transition:{duration:.2}},className:"mt-4 p-3 bg-gray-50/50 dark:bg-gray-800/30 rounded-xl border border-gray-200/50 dark:border-gray-700/50",children:(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-gray-600 dark:text-gray-400",children:[(0,r.jsx)(m.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Traffic Insights"})]}),(0,r.jsxs)("div",{className:"text-gray-900 dark:text-white font-medium",children:[t.peakHour&&"Peak: ".concat(t.peakHour),t.avgRequestsPerHour&&" â€¢ ".concat(t.avgRequestsPerHour.toLocaleString()," req/hr avg")]})]})})]})]}):(0,r.jsx)(l.P.div,{initial:{opacity:0,y:30,scale:.9},animate:{opacity:1,y:0,scale:1},transition:{type:"spring",stiffness:100,damping:12,duration:.7},className:"bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm rounded-2xl border border-gray-200 dark:border-gray-700/50 p-8 ".concat(a),children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(l.P.div,{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:150,damping:10,delay:.2},children:(0,r.jsx)(i.A,{className:"h-8 w-8 text-gray-400"})}),(0,r.jsx)(l.P.h3,{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:"No Request Data"}),(0,r.jsx)(l.P.p,{className:"text-gray-600 dark:text-gray-400",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:"Upload a log file to see request statistics and analytics."})]})})}var h=a(220),p=a(3547),b=a(8712),y=a(1940),f=a(9203),v=a(2805),j=a(148),N=a(5558);b.t1.register(b.Bs,b.m_,b.s$);let k={GET:"Retrieves data from the server",POST:"Submits data to be processed to the server",PUT:"Updates existing resource on the server",DELETE:"Removes specified resource from the server",PATCH:"Applies partial modifications to a resource",OPTIONS:"Describes communication options for the target resource",HEAD:"Same as GET but returns only HTTP headers",TRACE:"Performs a message loop-back test",CONNECT:"Establishes a tunnel to the server",MALFORMED:"Malformed or attack requests"},w={GET:{base:"#0ea5e9",hover:"#0284c7"},POST:{base:"#22c55e",hover:"#16a34a"},PUT:{base:"#f97316",hover:"#ea580c"},DELETE:{base:"#ef4444",hover:"#dc2626"},PATCH:{base:"#a855f7",hover:"#9333ea"},OPTIONS:{base:"#64748b",hover:"#475569"},HEAD:{base:"#ec4899",hover:"#db2777"},TRACE:{base:"#8b5cf6",hover:"#7c3aed"},CONNECT:{base:"#14b8a6",hover:"#0d9488"},MALFORMED:{base:"#f43f5e",hover:"#e11d48"}};function C(e){var t,a,i,n,o,d;let{data:c,className:x="",onFilter:m,activeFilter:u,parsedLines:b}=e,[C,S]=(0,s.useState)(!1),[A,P]=(0,s.useState)(null),[T,R]=(0,s.useState)([]),[L,E]=(0,s.useState)(!1),q=(0,s.useRef)(null);(0,s.useEffect)(()=>{S(document.documentElement.classList.contains("dark"));let e=new MutationObserver(()=>{S(document.documentElement.classList.contains("dark"))});return e.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>e.disconnect()},[]);let M=(0,s.useMemo)(()=>Object.values(c).reduce((e,t)=>e+t,0),[c]),D=(0,s.useMemo)(()=>0===M?[]:Object.entries(c).filter(e=>{let[t]=e;return t.length<=20}).map(e=>{let[t,a]=e;return{method:t,count:a,percentage:(a/M*100).toFixed(1)}}).sort((e,t)=>t.count-e.count),[c,M]);if(0===M)return(0,r.jsx)("div",{className:"p-8 ".concat(x),children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(y.A,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"No HTTP Method Data"})]})});let F=(0,s.useMemo)(()=>({labels:D.map(e=>e.method),datasets:[{data:D.map(e=>e.count),backgroundColor:D.map(e=>{var t,a,r,s;return u===e.method?null!=(r=null==(t=w[e.method])?void 0:t.hover)?r:"#475569":null!=(s=null==(a=w[e.method])?void 0:a.base)?s:"#64748b"}),hoverBackgroundColor:D.map(e=>{var t,a;return null!=(a=null==(t=w[e.method])?void 0:t.hover)?a:"#475569"}),borderWidth:4,borderColor:C?"rgba(31, 41, 55, 0.8)":"rgba(255, 255, 255, 0.9)",hoverBorderColor:C?"rgba(55, 65, 81, 0.8)":"rgba(249, 250, 251, 0.9)",hoverOffset:15}]}),[c,D,C,u]),I=(0,s.useMemo)(()=>({id:"centerText",afterDraw:e=>{let{ctx:t,chartArea:a}=e;if(!a)return;let{left:r,top:s,width:l,height:i}=a;t.save(),t.font="bold ".concat(Math.min(l/7,40),"px sans-serif"),t.fillStyle=C?"#f9fafb":"#111827",t.textAlign="center",t.textBaseline="middle";let n=M.toLocaleString();t.fillText(n,r+l/2,s+i/2-10),t.font="500 ".concat(Math.min(l/18,16),"px sans-serif"),t.fillStyle=C?"#9ca3af":"#6b7280",t.fillText("Total Requests",r+l/2,s+i/2+25),t.restore()}}),[C,M]),O=e=>{m&&m("method",u===e?null:e),b&&b.length>0&&u!==e&&(R(b.filter(t=>t.method===e)),P(e),E(!0))},U=()=>{E(!1)},H=(0,s.useMemo)(()=>({responsive:!0,maintainAspectRatio:!1,cutout:"70%",onClick:(e,t,a)=>{if(t.length>0&&a.data.labels){let e=t[0].index;O(a.data.labels[e])}},onHover:(e,t,a)=>{a.canvas.style.cursor=t.length>0?"pointer":"default"},animation:{animateScale:!0,animateRotate:!0,duration:1200,easing:"easeOutQuart"},plugins:{legend:{display:!1},tooltip:{enabled:!0,backgroundColor:C?"rgba(17, 24, 39, 0.9)":"rgba(255, 255, 255, 0.9)",titleColor:C?"#F9FAFB":"#111827",bodyColor:C?"#D1D5DB":"#374151",borderColor:C?"rgba(209, 213, 219, 0.2)":"rgba(0, 0, 0, 0.1)",borderWidth:1,padding:15,cornerRadius:12,displayColors:!0,boxPadding:4,callbacks:{title:e=>"Method: ".concat(e[0].label),label:e=>{let t=e.raw,a=(t/M*100).toFixed(1);return" ".concat(t.toLocaleString()," requests (").concat(a,"%)")},afterBody:e=>{var t,a;let r=null!=(t=e[0].label)?t:"Unknown";return"\n".concat(null!=(a=k[r])?a:"Other HTTP method")}}}}}),[C,M,m,u]);return(0,r.jsxs)("div",{className:"".concat(x," rounded-xl overflow-hidden"),children:[(0,r.jsxs)("div",{className:"p-6 pb-4 border-b border-gray-100 dark:border-gray-700/50",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 flex items-center space-x-2",children:[(0,r.jsx)(y.A,{className:"h-5 w-5 text-blue-500"}),(0,r.jsx)("span",{children:"HTTP Methods Distribution"})]}),(0,r.jsxs)("p",{className:"text-gray-600 dark:text-gray-300/80 mt-1 text-sm",children:["Breakdown of ",M.toLocaleString()," requests. Click to filter."]})]}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsx)("div",{className:"h-[200px] sm:h-[250px] md:h-[300px] relative",children:(0,r.jsx)(h.nu,{ref:q,data:F,options:H,plugins:[I],className:"relative z-10"},M)}),(0,r.jsx)("div",{className:"flex flex-wrap justify-center gap-3",children:D.map((e,t)=>{var a,s,i,n;return(0,r.jsxs)(l.P.div,{className:"flex items-center gap-2 text-sm cursor-pointer px-3 py-1.5 rounded-lg transition-all duration-200 ".concat(u===e.method?"bg-blue-50 dark:bg-blue-900/30 ring-1 ring-blue-200 dark:ring-blue-800/50":"hover:bg-gray-100/80 dark:hover:bg-gray-700/50"),whileHover:{scale:1.03},whileTap:{scale:.98},onClick:()=>O(e.method),onMouseEnter:()=>{q.current&&(q.current.setActiveElements([{datasetIndex:0,index:t}]),q.current.update())},onMouseLeave:()=>{q.current&&(q.current.setActiveElements([]),q.current.update())},children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-sm flex-shrink-0",style:{backgroundColor:u===e.method?null!=(i=null==(a=w[e.method])?void 0:a.hover)?i:"#475569":null!=(n=null==(s=w[e.method])?void 0:s.base)?n:"#64748b"}}),(0,r.jsx)("span",{className:"font-medium text-gray-700 dark:text-gray-200",children:e.method.length>20?"".concat(e.method.substring(0,17),"..."):e.method}),(0,r.jsxs)("span",{className:"text-gray-500 dark:text-gray-300/80",children:["(",e.percentage,"%)"]})]},e.method)})}),u&&(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsxs)(l.P.button,{onClick:()=>{m&&m("method",null)},className:"group px-4 py-2 rounded-lg transition-all duration-300 text-sm font-medium flex items-center gap-2 relative",style:{backgroundColor:null!=(o=null==(t=w[u])?void 0:t.base)?o:"#64748b"},whileHover:{scale:1.05,backgroundColor:null!=(d=null==(a=w[u])?void 0:a.hover)?d:"#475569"},whileTap:{scale:.95},animate:{scale:[1,1.05,1],transition:{duration:1.5,repeat:1/0,repeatType:"reverse"}},children:[(0,r.jsx)(f.A,{className:"w-4 h-4 text-white"}),(0,r.jsx)("span",{className:"text-white",children:"Clear Filter"}),(0,r.jsxs)("span",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs py-1 px-2 rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none whitespace-nowrap",children:["Remove ",u," filter"]})]})})]}),(0,r.jsx)(p.N,{children:L&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-md z-50 flex items-center justify-center p-4",children:(0,r.jsxs)(l.P.div,{className:"bg-white/90 dark:bg-gray-800/90 rounded-2xl shadow-2xl max-w-4xl w-full max-h-[85vh] flex flex-col border border-white/20 dark:border-gray-700/50",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{type:"spring",damping:25,stiffness:300},children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-5 border-b border-gray-200/50 dark:border-gray-700/50",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"px-3 py-1.5 rounded-lg text-sm font-semibold",style:{backgroundColor:"".concat(null==(i=w[A])?void 0:i.base,"20")||0,color:(null==(n=w[A])?void 0:n.base)||"#6366f1"},children:A}),(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Request Details"})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Showing ",T.length," logs"]})]}),(0,r.jsx)("button",{onClick:U,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors duration-200",children:(0,r.jsx)(f.A,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]}),(0,r.jsx)("div",{className:"overflow-auto flex-1 p-5",children:T.length>0?(0,r.jsxs)("div",{className:"space-y-3",children:[T.slice(0,50).map((e,t)=>{var a,s;return(0,r.jsx)("div",{className:"bg-white dark:bg-gray-700/30 p-4 rounded-xl border border-gray-200/50 dark:border-gray-600/30 shadow-sm hover:shadow-md transition-all duration-200",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsxs)("span",{className:"px-2.5 py-1 rounded-lg text-xs font-semibold flex-shrink-0 mt-1 flex items-center gap-1",style:{backgroundColor:"".concat(null==(a=w[A])?void 0:a.base,"20")||0,color:(null==(s=w[A])?void 0:s.base)||"#6366f1"},children:[(0,r.jsx)(v.A,{className:"w-3 h-3"}),e.method]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("div",{className:"text-gray-800 dark:text-gray-200 text-sm font-medium break-all mb-2",children:e.path}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 bg-gray-50 dark:bg-gray-700/50 p-2 rounded-lg",children:[(0,r.jsx)("div",{className:"bg-green-100 dark:bg-green-900/30 p-1 rounded-lg",children:(0,r.jsx)(j.A,{className:"w-3 h-3 text-green-600 dark:text-green-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Status"}),(0,r.jsx)("div",{className:"text-xs font-medium text-gray-800 dark:text-gray-200",children:e.status})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 bg-gray-50 dark:bg-gray-700/50 p-2 rounded-lg",children:[(0,r.jsx)("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-1 rounded-lg",children:(0,r.jsx)(N.A,{className:"w-3 h-3 text-blue-600 dark:text-blue-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Size"}),(0,r.jsxs)("div",{className:"text-xs font-medium text-gray-800 dark:text-gray-200",children:[e.bodyBytesSent," bytes"]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 bg-gray-50 dark:bg-gray-700/50 p-2 rounded-lg",children:[(0,r.jsx)("div",{className:"bg-purple-100 dark:bg-purple-900/30 p-1 rounded-lg",children:(0,r.jsx)(g.A,{className:"w-3 h-3 text-purple-600 dark:text-purple-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"IP"}),(0,r.jsx)("div",{className:"text-xs font-medium text-gray-800 dark:text-gray-200 font-mono",children:e.ipAddress})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 bg-gray-50 dark:bg-gray-700/50 p-2 rounded-lg",children:[(0,r.jsx)("div",{className:"bg-amber-100 dark:bg-amber-900/30 p-1 rounded-lg",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-3 h-3 text-amber-600 dark:text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Time"}),(0,r.jsx)("div",{className:"text-xs font-medium text-gray-800 dark:text-gray-200",children:(e=>{try{let t=e.match(/(\d{2})\/(\w{3})\/(\d{4}):(\d{2}):(\d{2}):(\d{2})/);if(t){let[,e,a,r,s,l]=t;return"".concat(a,"/").concat(e," ").concat(s,":").concat(l)}return e}catch(t){return e}})(e.timestamp)})]})]})]}),e.userAgent&&(0,r.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-200/50 dark:border-gray-600/30",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"User Agent"}),(0,r.jsx)("div",{className:"text-sm text-gray-700 dark:text-gray-300 break-all bg-gray-50 dark:bg-gray-700/30 p-2 rounded",children:e.userAgent})]}),e.referer&&"-"!==e.referer&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Referrer"}),(0,r.jsx)("div",{className:"text-sm text-gray-700 dark:text-gray-300 break-all bg-gray-50 dark:bg-gray-700/30 p-2 rounded",children:e.referer})]})]})]})},t)}),T.length>50&&(0,r.jsx)("div",{className:"text-center py-4 bg-gray-100/50 dark:bg-gray-700/30 rounded-lg mt-2",children:(0,r.jsxs)("div",{className:"inline-flex items-center gap-2 text-gray-600 dark:text-gray-300 text-sm",children:[(0,r.jsx)(g.A,{className:"w-4 h-4"}),(0,r.jsxs)("span",{children:["Showing first 50 of ",T.length," logs"]})]})})]}):(0,r.jsxs)("div",{className:"text-center py-16",children:[(0,r.jsx)("div",{className:"mx-auto w-24 h-24 bg-gray-100 dark:bg-gray-700/50 rounded-full flex items-center justify-center mb-6",children:(0,r.jsx)(N.A,{className:"h-12 w-12 text-gray-400 dark:text-gray-500"})}),(0,r.jsx)("h4",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"No Request Logs Found"}),(0,r.jsxs)("p",{className:"text-gray-500 dark:text-gray-400 max-w-md mx-auto",children:["No logs were found for the ",(0,r.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white",children:A})," method. This might indicate that no requests of this type were made during the monitoring period."]})]})}),(0,r.jsx)("div",{className:"p-5 border-t border-gray-200/50 dark:border-gray-700/50 flex justify-end",children:(0,r.jsx)("button",{onClick:U,className:"px-6 py-2.5 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white rounded-xl transition-all duration-200 font-medium shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:"Done"})})]})})})]})}var S=a(7315),A=a(7702),P=a(3492),T=a(8484),R=a(1809);b.t1.register(b.PP,b.kc,b.E8,b.hE,b.m_,b.s$);let L={"1xx":{base:"#60a5fa",hover:"#3b82f6"},"2xx":{base:"#4ade80",hover:"#22c55e"},"3xx":{base:"#fbbf24",hover:"#f59e0b"},"4xx":{base:"#f87171",hover:"#ef4444"},"5xx":{base:"#a78bfa",hover:"#8b5cf6"}};function E(e){var t,a,i,n;let{data:o,className:d="",onFilter:c,activeFilter:x,parsedLines:m}=e,[u,b]=(0,s.useState)(!1),[y,k]=(0,s.useState)(null),[w,C]=(0,s.useState)([]),[E,q]=(0,s.useState)(!1);(0,s.useEffect)(()=>{b(document.documentElement.classList.contains("dark"));let e=new MutationObserver(()=>{b(document.documentElement.classList.contains("dark"))});return e.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>e.disconnect()},[]);let M=()=>{q(!1)},{totalRequests:D,sortedLabels:F,sortedData:I,metrics:O}=(0,s.useMemo)(()=>{let e=Object.values(o).reduce((e,t)=>e+t,0);if(0===e)return{totalRequests:0,sortedLabels:[],sortedData:[],metrics:[]};let t={"1xx":0,"2xx":0,"3xx":0,"4xx":0,"5xx":0};Object.entries(o).forEach(e=>{let[a,r]=e;t[a]+=r});let a=Object.entries(t).filter(e=>{let[,t]=e;return t>0}),r=a.map(e=>{let[t]=e;return t}),s=a.map(e=>{let[,t]=e;return t}),l=t["2xx"],i=e>0?l/e*100:0,n=[{title:"Success Rate",value:"".concat(i.toFixed(1),"%"),icon:S.A,color:"green"},{title:"Client Errors",value:t["4xx"].toLocaleString(),icon:A.A,color:"red"},{title:"Server Errors",value:t["5xx"].toLocaleString(),icon:P.A,color:"purple"},{title:"Total Requests",value:e.toLocaleString(),icon:T.A,color:"blue"}];return{totalRequests:e,sortedLabels:r,sortedData:s,metrics:n}},[o]);if(0===D)return(0,r.jsx)("div",{className:"p-8 ".concat(d),children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(R.A,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"No Status Code Data"})]})});let U=(0,s.useMemo)(()=>({labels:F,datasets:[{label:"Request Count",data:I,backgroundColor:F.map(e=>{var t,a;return x===e?null==(t=L[e])?void 0:t.hover:null==(a=L[e])?void 0:a.base}),borderColor:F.map(e=>{var t;return null==(t=L[e])?void 0:t.hover}),borderWidth:2,borderRadius:8,hoverBackgroundColor:F.map(e=>{var t;return null==(t=L[e])?void 0:t.hover})}]}),[F,I,x]),H={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100}}};return(0,r.jsxs)("div",{className:d,children:[(0,r.jsxs)("div",{className:"p-6 pb-4 border-b border-gray-200/50 dark:border-gray-700/50",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center space-x-2",children:[(0,r.jsx)(R.A,{className:"h-5 w-5 text-green-500"}),(0,r.jsx)("span",{children:"Status Code Distribution"})]}),(0,r.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:["Analysis of ",D.toLocaleString()," server responses."]})]}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsx)("div",{className:"h-[200px] sm:h-[250px] md:h-[300px] relative",children:(0,r.jsx)(h.yP,{data:U,options:{responsive:!0,maintainAspectRatio:!1,onClick:(e,t,a)=>{if(t.length>0&&a.data.labels){var r;let e=t[0].index;r=a.data.labels[e],c&&c("status",x===r?null:r),m&&m.length>0&&x!==r&&(C(m.filter(e=>{var t;let a=null==(t=e.status)?void 0:t.toString();return!!a&&a.startsWith(r.charAt(0))})),k(r),q(!0))}},onHover:(e,t,a)=>{a.canvas.style.cursor=t.length>0?"pointer":"default"},animation:{duration:1200,easing:"easeOutQuart"},plugins:{legend:{display:!1},tooltip:{enabled:!0,backgroundColor:u?"rgba(17, 24, 39, 0.9)":"rgba(255, 255, 255, 0.9)",titleColor:u?"#F9FAFB":"#111827",bodyColor:u?"#D1D5DB":"#374151",borderColor:u?"rgba(209, 213, 219, 0.2)":"rgba(0, 0, 0, 0.1)",borderWidth:1,padding:15,cornerRadius:12,displayColors:!1,callbacks:{title:e=>"Status: ".concat(e[0].label),label:e=>{let t=e.raw,a=(t/D*100).toFixed(1);return"".concat(t.toLocaleString()," requests (").concat(a,"%)")}}}},scales:{y:{beginAtZero:!0,grid:{color:u?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.05)"},border:{display:!1},ticks:{color:u?"#9ca3af":"#6b7280",padding:10}},x:{grid:{display:!1},ticks:{color:u?"#9ca3af":"#6b7280",font:{weight:600}}}}}})}),(0,r.jsx)(l.P.div,{className:"grid grid-cols-2 md:grid-cols-4 gap-4 pt-4 border-t border-gray-200/50 dark:border-gray-700/50",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"visible",children:O.map(e=>{let t=e.icon;return(0,r.jsxs)(l.P.div,{variants:H,className:"bg-white/50 dark:bg-gray-800/50 p-4 rounded-lg text-center transition-all duration-200 hover:shadow-md hover:-translate-y-1",children:[(0,r.jsx)(t,{className:"h-7 w-7 mx-auto p-1 rounded-full ".concat({blue:"bg-sky-100 dark:bg-sky-900/30 text-sky-600 dark:text-sky-300",green:"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-300",purple:"bg-violet-100 dark:bg-violet-900/30 text-violet-600 dark:text-violet-300",red:"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-300"}[e.color])}),(0,r.jsx)("dd",{className:"text-xl font-bold text-gray-800 dark:text-gray-100 mt-2",children:e.value}),(0,r.jsx)("dt",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:e.title})]},e.title)})})]}),x&&(0,r.jsx)("div",{className:"flex justify-center pt-4",children:(0,r.jsxs)(l.P.button,{onClick:()=>{c&&c("status",null)},className:"group px-4 py-2 rounded-lg transition-all duration-300 text-sm font-medium flex items-center gap-2 relative",style:{backgroundColor:null!=(i=null==(t=L[x])?void 0:t.base)?i:"#64748b"},whileHover:{scale:1.05,backgroundColor:null!=(n=null==(a=L[x])?void 0:a.hover)?n:"#475569"},whileTap:{scale:.95},animate:{scale:[1,1.05,1],transition:{duration:1.5,repeat:1/0,repeatType:"reverse"}},children:[(0,r.jsx)(f.A,{className:"w-4 h-4 text-white"}),(0,r.jsx)("span",{className:"text-white",children:"Clear Filter"}),(0,r.jsxs)("span",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs py-1 px-2 rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none whitespace-nowrap",children:["Remove ",x," filter"]})]})}),(0,r.jsx)(p.N,{children:E&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-md z-50 flex items-center justify-center p-4",children:(0,r.jsxs)(l.P.div,{className:"bg-white/90 dark:bg-gray-800/90 rounded-2xl shadow-2xl max-w-4xl w-full max-h-[85vh] flex flex-col border border-white/20 dark:border-gray-700/50",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{type:"spring",damping:25,stiffness:300},children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-5 border-b border-gray-200/50 dark:border-gray-700/50",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"px-3 py-1.5 rounded-lg text-sm font-semibold flex items-center gap-2 ".concat((null==y?void 0:y.startsWith("2"))?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200":(null==y?void 0:y.startsWith("4"))?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200":(null==y?void 0:y.startsWith("5"))?"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200":"bg-gray-100 dark:bg-gray-700/50 text-gray-800 dark:text-gray-200"),children:[(0,r.jsx)(j.A,{className:"w-4 h-4"}),y]}),(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Status Code Details"})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Showing ",w.length," requests"]})]}),(0,r.jsx)("button",{onClick:M,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors duration-200",children:(0,r.jsx)(f.A,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-5",children:w.length>0?(0,r.jsxs)("div",{className:"space-y-4",children:[w.slice(0,50).map((e,t)=>(0,r.jsx)("div",{className:"bg-white dark:bg-gray-700/30 p-4 rounded-xl border border-gray-200/50 dark:border-gray-600/30 shadow-sm hover:shadow-md transition-all duration-200",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsxs)("div",{className:"px-2.5 py-1 rounded-lg text-xs font-semibold flex-shrink-0 mt-1 flex items-center gap-1 ".concat(e.status.startsWith("2")?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200":e.status.startsWith("4")?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200":e.status.startsWith("5")?"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200":"bg-gray-100 dark:bg-gray-700/50 text-gray-800 dark:text-gray-200"),children:[(0,r.jsx)(j.A,{className:"w-3 h-3"}),e.status]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"text-gray-800 dark:text-gray-200 text-sm font-medium break-all mb-2",children:[e.method," ",e.path]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 bg-gray-50 dark:bg-gray-700/50 p-2 rounded-lg",children:[(0,r.jsx)("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-1 rounded-lg",children:(0,r.jsx)(N.A,{className:"w-3 h-3 text-blue-600 dark:text-blue-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Size"}),(0,r.jsxs)("div",{className:"text-xs font-medium text-gray-800 dark:text-gray-200",children:[e.bodyBytesSent," bytes"]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 bg-gray-50 dark:bg-gray-700/50 p-2 rounded-lg",children:[(0,r.jsx)("div",{className:"bg-purple-100 dark:bg-purple-900/30 p-1 rounded-lg",children:(0,r.jsx)(g.A,{className:"w-3 h-3 text-purple-600 dark:text-purple-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"IP"}),(0,r.jsx)("div",{className:"text-xs font-medium text-gray-800 dark:text-gray-200 font-mono",children:e.ipAddress})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 bg-gray-50 dark:bg-gray-700/50 p-2 rounded-lg",children:[(0,r.jsx)("div",{className:"bg-amber-100 dark:bg-amber-900/30 p-1 rounded-lg",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-3 h-3 text-amber-600 dark:text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Time"}),(0,r.jsx)("div",{className:"text-xs font-medium text-gray-800 dark:text-gray-200",children:(e=>{try{let t=e.match(/(\d{2})\/(\w{3})\/(\d{4}):(\d{2}):(\d{2}):(\d{2})/);if(t){let[,e,a,r,s,l]=t;return"".concat(a,"/").concat(e," ").concat(s,":").concat(l)}return e}catch(t){return e}})(e.timestamp)})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 bg-gray-50 dark:bg-gray-700/50 p-2 rounded-lg",children:[(0,r.jsx)("div",{className:"bg-cyan-100 dark:bg-cyan-900/30 p-1 rounded-lg",children:(0,r.jsx)(v.A,{className:"w-3 h-3 text-cyan-600 dark:text-cyan-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Method"}),(0,r.jsx)("div",{className:"text-xs font-medium text-gray-800 dark:text-gray-200",children:e.method})]})]})]}),e.userAgent&&(0,r.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-200/50 dark:border-gray-600/30",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"User Agent"}),(0,r.jsx)("div",{className:"text-sm text-gray-700 dark:text-gray-300 break-all bg-gray-50 dark:bg-gray-700/30 p-2 rounded",children:e.userAgent})]}),e.referer&&"-"!==e.referer&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Referrer"}),(0,r.jsx)("div",{className:"text-sm text-gray-700 dark:text-gray-300 break-all bg-gray-50 dark:bg-gray-700/30 p-2 rounded",children:e.referer})]})]})]})},t)),w.length>50&&(0,r.jsx)("div",{className:"text-center py-4 bg-gray-100/50 dark:bg-gray-700/30 rounded-lg mt-2",children:(0,r.jsxs)("div",{className:"inline-flex items-center gap-2 text-gray-600 dark:text-gray-300 text-sm",children:[(0,r.jsx)(g.A,{className:"w-4 h-4"}),(0,r.jsxs)("span",{children:["Showing first 50 of ",w.length," logs"]})]})})]}):(0,r.jsxs)("div",{className:"text-center py-16",children:[(0,r.jsx)("div",{className:"mx-auto w-24 h-24 bg-gray-100 dark:bg-gray-700/50 rounded-full flex items-center justify-center mb-6",children:(0,r.jsx)(T.A,{className:"h-12 w-12 text-gray-400 dark:text-gray-500"})}),(0,r.jsx)("h4",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"No Status Code Logs Found"}),(0,r.jsxs)("p",{className:"text-gray-500 dark:text-gray-400 max-w-md mx-auto",children:["No logs were found for the ",(0,r.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white",children:y})," status codes. This might indicate that no responses with these status codes were recorded during the monitoring period."]})]})}),(0,r.jsx)("div",{className:"p-5 border-t border-gray-200/50 dark:border-gray-700/50 flex justify-end",children:(0,r.jsx)("button",{onClick:M,className:"px-6 py-2.5 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white rounded-xl transition-all duration-200 font-medium shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:"Done"})})]})})})]})}var q=a(2427),M=a(5693);b.t1.register(b.pr,b.FN,b.No,b.dN,b.m_,b.s$);let D=e=>{let{activeFilter:t}=e;return(0,r.jsxs)("div",{className:"p-6 pb-4 border-b border-gray-200/50 dark:border-gray-700/50",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center space-x-2",children:[(0,r.jsx)(q.A,{className:"h-5 w-5 text-red-500"}),(0,r.jsx)("span",{children:"Attack Distribution"})]}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:t?"Filtered by: ".concat(t):"Distribution of security threats. Click a point to filter."})]})},F=e=>{let{attackType:t,count:a,onClearFilter:s}=e;return(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"h-[200px] flex flex-col items-center justify-center bg-gray-50 dark:bg-gray-800/50 rounded-lg text-center",children:[a>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.A,{className:"h-12 w-12 mx-auto text-orange-400 mb-2"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:a.toLocaleString()}),(0,r.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:[t," events"]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(M.A,{className:"h-12 w-12 mx-auto text-gray-400 mb-2"}),(0,r.jsxs)("p",{className:"text-gray-500 dark:text-gray-400",children:["No ",t," events found."]})]}),(0,r.jsxs)("button",{onClick:s,className:"mt-6 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:[(0,r.jsx)(f.A,{className:"w-4 h-4"}),"Clear Filter"]})]})})},I=()=>(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)("div",{className:"h-[200px] flex items-center justify-center bg-gray-50 dark:bg-gray-800/50 rounded-lg",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(M.A,{className:"h-12 w-12 mx-auto text-gray-400 mb-2"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No attack data available"})]})})});function O(e){let{data:t={},allAttackTypes:a=[],className:l="",onFilter:i,activeFilter:n}=e,o=t||{},d=a||[],[c,x]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=()=>{x(document.documentElement.classList.contains("dark"))};e();let t=new MutationObserver(e);return t.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),window.addEventListener("storage",e),()=>{t.disconnect(),window.removeEventListener("storage",e)}},[]);let g=(0,s.useMemo)(()=>Object.values(o).reduce((e,t)=>e+("number"==typeof t?t:Number(t)||0),0),[o]),m=(0,s.useMemo)(()=>({labels:d,datasets:[{label:"Attack Count",data:d.map(e=>{let t=o[e];return"number"==typeof t?t:Number(t)||0}),backgroundColor:c?"rgba(255, 0, 0, 0.2)":"rgba(220, 38, 38, 0.15)",borderColor:c?"rgba(255, 50, 50, 1)":"rgba(220, 38, 38, 1)",borderWidth:3,pointBackgroundColor:c?"rgba(255, 100, 100, 1)":"rgba(220, 38, 38, 1)",pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgba(220, 38, 38, 1)",pointRadius:6,pointHoverRadius:8}]}),[o,d,c]);if(n){let e=o[n],t="number"==typeof e?e:Number(e)||0;return(0,r.jsxs)("div",{className:l,children:[(0,r.jsx)(D,{activeFilter:n}),(0,r.jsx)(F,{attackType:n,count:t,onClearFilter:()=>null==i?void 0:i("attackType",null)})]})}return 0===g?(0,r.jsxs)("div",{className:l,children:[(0,r.jsx)(D,{activeFilter:null}),(0,r.jsx)(I,{})]}):(0,r.jsxs)("div",{className:l,children:[(0,r.jsx)(D,{activeFilter:null}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)("div",{className:"h-[200px] sm:h-[250px] md:h-[300px] relative",children:(0,r.jsx)(h.Vd,{data:m,options:{responsive:!0,maintainAspectRatio:!1,onClick:(e,t)=>{t.length>0&&i&&i("attackType",m.labels[t[0].index])},onHover:(e,t,a)=>{a.canvas.style.cursor=t.length>0?"pointer":"default"},plugins:{legend:{display:!1},tooltip:{enabled:!0,backgroundColor:c?"rgba(30, 41, 59, 0.95)":"rgba(255, 255, 255, 0.95)",titleColor:c?"#f9fafb":"#111827",bodyColor:c?"#e5e7eb":"#374151",callbacks:{title:e=>"Attack Type: ".concat(e[0].label),label:e=>{let t=e.raw,a=g>0?(t/g*100).toFixed(1):0;return"".concat(t.toLocaleString()," events (").concat(a,"%)")}}}},scales:{r:{beginAtZero:!0,grid:{color:c?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)"},angleLines:{color:c?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)"},pointLabels:{color:c?"#ffffff":"#374151",font:{size:12,weight:"bold"}},ticks:{display:!1}}}}})})})]})}var U=a(397),H=a(7299),W=a(2899);b.t1.register(b.PP,b.kc,b.FN,b.No,b.hE,b.m_,b.s$,b.dN);var B=a(1413),z=a.n(B),_=a(2528),V=a(4792),X=a(6300),G=a(8297),Y=a(9202),Z=a(611);function J(e){var t,a;let{data:i,className:n=""}=e,[o,d]=(0,s.useState)([]),[c,g]=(0,s.useState)([]),[m,u]=(0,s.useState)(""),h=(0,s.useMemo)(()=>Array.from(new Set(i.map(e=>e.attackType))),[i]),p=(0,s.useMemo)(()=>Array.from(new Set(i.map(e=>e.ipAddress))),[i]),b=(0,s.useMemo)(()=>[{accessorKey:"timestamp",header:e=>{let{column:t}=e;return(0,r.jsxs)("button",{className:"flex items-center gap-2 text-left w-full group",onClick:()=>t.toggleSorting("asc"===t.getIsSorted()),children:[(0,r.jsx)("span",{children:"Timestamp"}),(0,r.jsx)(X.A,{className:"h-4 w-4 opacity-0 group-hover:opacity-100 transition-opacity"})]})},cell:e=>{let{row:t}=e,a=(e=>{let t=e.match(/(\d{2})\/(\w{3})\/(\d{4}):(\d{2}):(\d{2}):(\d{2})/);if(!t)return null;let[,a,r,s,l,i,n]=t,o={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[r];return void 0===o?null:new Date(Date.UTC(Number(s),o,Number(a),Number(l),Number(i),Number(n)))})(t.getValue("timestamp"));return a?(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:a.toLocaleDateString()}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"font-mono text-xs text-gray-500 dark:text-gray-400",children:a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),(0,r.jsx)("span",{className:"text-xs px-1.5 py-0.5 bg-gray-100 dark:bg-gray-700 rounded-full text-gray-500 dark:text-gray-400",children:(e=>{let t=Math.floor((new Date().getTime()-e.getTime())/1e3);return t<60?"".concat(t,"s ago"):t<3600?"".concat(Math.floor(t/60),"m ago"):t<86400?"".concat(Math.floor(t/3600),"h ago"):"".concat(Math.floor(t/86400),"d ago")})(a)})]})]}):(0,r.jsx)("span",{className:"text-gray-500",children:"Invalid Date"})}},{accessorKey:"ipAddress",header:"IP Address",cell:e=>(0,r.jsx)("span",{className:"font-mono px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded text-sm",children:e.getValue()}),filterFn:(e,t,a)=>a.includes(e.getValue(t))},{accessorKey:"attackType",header:"Attack Type",cell:e=>{let t=e.getValue(),a=t.includes("SQLi")?"bg-red-500/10 text-red-500 border border-red-500/20":t.includes("XSS")?"bg-yellow-500/10 text-yellow-500 border border-yellow-500/20":"bg-purple-500/10 text-purple-500 border border-purple-500/20";return(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(a),children:t})},filterFn:(e,t,a)=>a.includes(e.getValue(t))},{accessorKey:"requestPath",header:"Request Path",cell:e=>(0,r.jsx)("span",{className:"font-mono text-sm break-all max-w-xs md:max-w-md truncate block",title:e.getValue(),children:e.getValue()}),filterFn:"includesString"}],[]),y=(0,_.N4)({data:i,columns:b,state:{sorting:o,columnFilters:c,globalFilter:m},onSortingChange:d,onColumnFiltersChange:g,onGlobalFilterChange:u,getCoreRowModel:(0,V.HT)(),getSortedRowModel:(0,V.h5)(),getPaginationRowModel:(0,V.kW)(),getFilteredRowModel:(0,V.hM)(),initialState:{pagination:{pageSize:8},sorting:[{id:"timestamp",desc:!0}]}}),v={hidden:{y:10,opacity:0},visible:{y:0,opacity:1}},j=(null==(t=y.getColumn("attackType"))?void 0:t.getFilterValue())||[],N=(null==(a=y.getColumn("ipAddress"))?void 0:a.getFilterValue())||[];return(0,r.jsxs)("div",{className:"jsx-3b82e271e41aad42 "+(n||""),children:[(0,r.jsxs)("div",{className:"jsx-3b82e271e41aad42 px-6 py-6 pb-4 border-b border-gray-200/50 dark:border-gray-700/50",children:[(0,r.jsxs)("h2",{className:"jsx-3b82e271e41aad42 text-xl font-bold flex items-center gap-2 text-gray-900 dark:text-white",children:[(0,r.jsx)(x.A,{className:"h-5 w-5 text-red-500"}),"Recent Security Events"]}),(0,r.jsx)("p",{className:"jsx-3b82e271e41aad42 text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Detected threats and suspicious activities from logs"})]}),(0,r.jsx)("div",{className:"jsx-3b82e271e41aad42 px-6 py-4 border-b border-gray-200/50 dark:border-gray-700/50 bg-gray-50/50 dark:bg-gray-700/30",children:(0,r.jsxs)("div",{className:"jsx-3b82e271e41aad42 flex flex-col md:flex-row gap-4",children:[(0,r.jsxs)("div",{className:"jsx-3b82e271e41aad42 flex-1 relative",children:[(0,r.jsx)(G.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:"Search request paths...",value:null!=m?m:"",onChange:e=>u(e.target.value),className:"jsx-3b82e271e41aad42 w-full pl-10 pr-4 py-2.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm transition-all"}),m&&(0,r.jsx)("button",{onClick:()=>u(""),className:"jsx-3b82e271e41aad42 absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,r.jsx)(f.A,{className:"h-4 w-4"})})]}),(0,r.jsxs)("div",{className:"jsx-3b82e271e41aad42 flex flex-col sm:flex-row gap-4 md:gap-3",children:[(0,r.jsx)("div",{className:"jsx-3b82e271e41aad42 w-full sm:w-48",children:(0,r.jsxs)("div",{className:"jsx-3b82e271e41aad42 relative",children:[(0,r.jsxs)("select",{value:j[0]||"",onChange:e=>{var t;let a=e.target.value;null==(t=y.getColumn("attackType"))||t.setFilterValue(a?[a]:void 0)},className:"jsx-3b82e271e41aad42 w-full py-2.5 px-3 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm appearance-none transition-all",children:[(0,r.jsx)("option",{value:"",className:"jsx-3b82e271e41aad42",children:"All Attack Types"}),h.map(e=>(0,r.jsx)("option",{value:e,className:"jsx-3b82e271e41aad42",children:e},e))]}),(0,r.jsx)("div",{className:"jsx-3b82e271e41aad42 absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:(0,r.jsx)(X.A,{className:"h-4 w-4 text-gray-400"})})]})}),(0,r.jsx)("div",{className:"jsx-3b82e271e41aad42 w-full sm:w-48",children:(0,r.jsxs)("div",{className:"jsx-3b82e271e41aad42 relative",children:[(0,r.jsxs)("select",{value:N[0]||"",onChange:e=>{var t;let a=e.target.value;null==(t=y.getColumn("ipAddress"))||t.setFilterValue(a?[a]:void 0)},className:"jsx-3b82e271e41aad42 w-full py-2.5 px-3 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm appearance-none transition-all",children:[(0,r.jsx)("option",{value:"",className:"jsx-3b82e271e41aad42",children:"All IP Addresses"}),p.map(e=>(0,r.jsx)("option",{value:e,className:"jsx-3b82e271e41aad42",children:e},e))]}),(0,r.jsx)("div",{className:"jsx-3b82e271e41aad42 absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:(0,r.jsx)(X.A,{className:"h-4 w-4 text-gray-400"})})]})}),(j.length>0||N.length>0||m)&&(0,r.jsx)("div",{className:"jsx-3b82e271e41aad42 flex items-center",children:(0,r.jsxs)("button",{onClick:()=>{var e,t;u(""),null==(e=y.getColumn("attackType"))||e.setFilterValue(void 0),null==(t=y.getColumn("ipAddress"))||t.setFilterValue(void 0)},className:"jsx-3b82e271e41aad42 flex items-center gap-1.5 text-sm text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-200/50 dark:hover:bg-gray-700/50 px-3 py-2.5 rounded-lg transition-colors",children:[(0,r.jsx)(f.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"jsx-3b82e271e41aad42",children:"Clear filters"})]})})]})]})}),(0,r.jsxs)("div",{className:"jsx-3b82e271e41aad42 p-6",children:[(0,r.jsx)("div",{className:"jsx-3b82e271e41aad42 overflow-x-auto custom-scrollbar",children:(0,r.jsxs)("table",{className:"jsx-3b82e271e41aad42 min-w-full text-sm",children:[(0,r.jsx)("thead",{className:"jsx-3b82e271e41aad42 border-b border-gray-200/50 dark:border-gray-700/50",children:y.getHeaderGroups().map(e=>(0,r.jsx)("tr",{className:"jsx-3b82e271e41aad42",children:e.headers.map(e=>(0,r.jsx)("th",{className:"jsx-3b82e271e41aad42 px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:e.isPlaceholder?null:(0,_.Kv)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,r.jsx)(l.P.tbody,{variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},initial:"hidden",animate:"visible",children:y.getRowModel().rows.length?y.getRowModel().rows.map(e=>(0,r.jsx)(l.P.tr,{variants:v,className:"border-b border-gray-200/50 dark:border-gray-700/50 hover:bg-gray-50/50 dark:hover:bg-gray-700/20",children:e.getVisibleCells().map(e=>(0,r.jsx)("td",{className:"jsx-3b82e271e41aad42 px-4 py-3 text-gray-700 dark:text-gray-300 align-top",children:(0,_.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,r.jsx)("tr",{className:"jsx-3b82e271e41aad42",children:(0,r.jsx)("td",{colSpan:b.length,className:"jsx-3b82e271e41aad42 text-center py-8 text-gray-500 dark:text-gray-400",children:"No security events found matching your filters"})})})]})}),(0,r.jsxs)("div",{className:"jsx-3b82e271e41aad42 flex flex-col sm:flex-row items-center justify-between gap-4 mt-6",children:[(0,r.jsxs)("span",{className:"jsx-3b82e271e41aad42 text-xs text-gray-600 dark:text-gray-400",children:["Showing ",y.getState().pagination.pageIndex*y.getState().pagination.pageSize+1," to"," ",Math.min((y.getState().pagination.pageIndex+1)*y.getState().pagination.pageSize,y.getFilteredRowModel().rows.length)," of ",y.getFilteredRowModel().rows.length," events"]}),(0,r.jsxs)("div",{className:"jsx-3b82e271e41aad42 flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>y.previousPage(),disabled:!y.getCanPreviousPage(),className:"jsx-3b82e271e41aad42 p-2 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:(0,r.jsx)(Y.A,{className:"h-5 w-5"})}),(0,r.jsx)("div",{className:"jsx-3b82e271e41aad42 flex items-center",children:(0,r.jsxs)("span",{className:"jsx-3b82e271e41aad42 text-sm font-medium text-gray-700 dark:text-gray-300",children:["Page ",y.getState().pagination.pageIndex+1," of ",y.getPageCount()]})}),(0,r.jsx)("button",{onClick:()=>y.nextPage(),disabled:!y.getCanNextPage(),className:"jsx-3b82e271e41aad42 p-2 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:(0,r.jsx)(Z.A,{className:"h-5 w-5"})})]})]})]}),(0,r.jsx)(z(),{id:"3b82e271e41aad42",children:".custom-scrollbar.jsx-3b82e271e41aad42::-webkit-scrollbar{height:6px}.custom-scrollbar.jsx-3b82e271e41aad42::-webkit-scrollbar-track{background:transparent}.custom-scrollbar.jsx-3b82e271e41aad42::-webkit-scrollbar-thumb{background-color:rgba(156,163,175,.5);border-radius:3px}.custom-scrollbar.jsx-3b82e271e41aad42:hover::-webkit-scrollbar-thumb{background-color:rgba(156,163,175,.8)}.custom-scrollbar.jsx-3b82e271e41aad42{scrollbar-width:thin;scrollbar-color:rgba(156,163,175,.5)transparent}"})]})}var K=a(1811);b.t1.register(b.PP,b.kc,b.E8,b.hE,b.m_,b.s$);let Q=function(e){let{data:t,suspiciousIps:a={},className:l="",onFilter:i,activeFilter:n}=e,[o,d]=(0,s.useState)({}),[c,x]=(0,s.useState)(!0),[g,m]=(0,s.useState)(!1);(0,s.useEffect)(()=>{m(document.documentElement.classList.contains("dark"));let e=new MutationObserver(()=>{m(document.documentElement.classList.contains("dark"))});return e.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>e.disconnect()},[]);let u=(0,s.useMemo)(()=>Object.entries(t).sort((e,t)=>t[1]-e[1]).slice(0,7),[t]);if((0,s.useEffect)(()=>{let e="ipinfo_",t=t=>{try{let a=localStorage.getItem("".concat(e).concat(t));if(!a)return null;let{data:r,timestamp:s}=JSON.parse(a);if(Date.now()-s>864e5)return localStorage.removeItem("".concat(e).concat(t)),null;return r}catch(e){return console.error("Error reading cache for IP ".concat(t,":"),e),null}},a=async a=>{let r=t(a);if(r)return r;try{await new Promise(e=>setTimeout(e,100));let t=await fetch("https://ipinfo.io/".concat(a,"/json/"));if(!t.ok){if(429===t.status)return console.warn("Rate limited for IP ".concat(a,". Using fallback data.")),{city:"Rate Limited",country:"N/A"};throw Error("HTTP ".concat(t.status))}let r=await t.json(),s=new Intl.DisplayNames(["en"],{type:"region"}).of(r.country)||r.region||"Unknown",l={city:r.city||"Unknown",country:s,flag:r.country?"https://flagcdn.com/16x12/".concat(r.country.toLowerCase(),".png"):void 0};try{let t={data:l,timestamp:Date.now()};localStorage.setItem("".concat(e).concat(a),JSON.stringify(t))}catch(e){console.error("Error caching info for IP ".concat(a,":"),e)}return l}catch(e){return console.error("Error fetching info for IP ".concat(a,":"),e),{city:"N/A",country:"N/A"}}},r=async()=>{x(!0);let e=u.map(e=>{let[t]=e;return t}),r={},s=[];if(e.forEach(e=>{let a=t(e);a?r[e]=a:s.push(e)}),d(r),s.length>0){let e=s.map(e=>a(e)),t=await Promise.all(e),l={...r};s.forEach((e,a)=>{l[e]=t[a]}),d(l)}x(!1)};u.length>0?r():(x(!1),d({}))},[u]),!t||0===Object.keys(t).length)return(0,r.jsx)("div",{className:"p-8 ".concat(l),children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(K.A,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"No IP Address Data"})]})});let p=(0,s.useMemo)(()=>({labels:u.map(e=>{let[t]=e;return t}),datasets:[{label:"Requests",data:u.map(e=>{let[,t]=e;return t}),backgroundColor:u.map(e=>{let[t]=e;return n===t?a[t]?"rgba(220, 38, 38, 1)":"rgba(37, 99, 235, 1)":a[t]?g?"rgba(239, 68, 68, 0.5)":"rgba(239, 68, 68, 0.7)":g?"rgba(59, 130, 246, 0.5)":"rgba(59, 130, 246, 0.7)"}),borderColor:u.map(e=>{let[t]=e;return a[t]?"rgba(239, 68, 68, 1)":"rgba(59, 130, 246, 1)"}),borderWidth:2,borderRadius:6,hoverBackgroundColor:u.map(e=>{let[t]=e;return a[t]?"rgba(239, 68, 68, 1)":"rgba(59, 130, 246, 1)"})}]}),[u,a,n,g]);return(0,r.jsxs)("div",{className:l,children:[(0,r.jsxs)("div",{className:"p-6 pb-4 border-b border-gray-200/50 dark:border-gray-700/50",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center space-x-2",children:[(0,r.jsx)(K.A,{className:"h-5 w-5 text-blue-500"}),(0,r.jsx)("span",{children:"Top IP Addresses"})]}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Top IP addresses by request volume. Click to filter."})]}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsx)("div",{className:"h-[200px] sm:h-[250px] relative",children:(0,r.jsx)(h.yP,{data:p,options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,onClick:(e,t,a)=>{if(t.length>0&&i&&a.data.labels){let e=t[0].index,r=a.data.labels[e];void 0!==r&&i("ipAddress",n===r?null:r)}},onHover:(e,t,a)=>{a.canvas.style.cursor=t.length>0?"pointer":"default"},animation:{duration:1200,easing:"easeOutQuart"},plugins:{legend:{display:!1},tooltip:{enabled:!0,backgroundColor:g?"rgba(17, 24, 39, 0.9)":"rgba(255, 255, 255, 0.9)",titleColor:g?"#F9FAFB":"#111827",bodyColor:g?"#D1D5DB":"#374151",borderColor:g?"rgba(209, 213, 219, 0.2)":"rgba(0, 0, 0, 0.1)",borderWidth:1,padding:15,cornerRadius:12,displayColors:!1,callbacks:{title:e=>{let t=e[0].label;return a[t]?"IP: ".concat(t," (Suspicious)"):"IP: ".concat(t)},label:e=>{let t=e.label,r=e.raw,s=o[t];if(!s)return["Requests: ".concat(r.toLocaleString()),"Location: Loading..."];if("Rate Limited"===s.city)return["Requests: ".concat(r.toLocaleString()),"Location: Rate limit reached. Data unavailable."];let l="".concat(s.city,", ").concat(s.country);return["Requests: ".concat(r.toLocaleString()),"Location: ".concat(l).concat(a[t]?" (Suspicious IP)":"")]}}}},scales:{y:{grid:{display:!1},ticks:{color:g?"#9ca3af":"#6b7280",font:{size:10}}},x:{beginAtZero:!0,grid:{color:g?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.05)"},ticks:{color:g?"#9ca3af":"#6b7280"},border:{display:!1}}}}})}),(0,r.jsxs)("div",{className:"flex items-center justify-end gap-4 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-4 h-4 bg-blue-500 rounded mr-2"}),(0,r.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Normal IP"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-4 h-4 bg-red-500 rounded mr-2"}),(0,r.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Suspicious IP"})]})]})]})]})};var $=a(6527);b.t1.register(b.PP,b.kc,b.E8,b.hE,b.m_,b.s$);let ee=function(e){let{data:t,className:a=""}=e,[l,i]=(0,s.useState)(!1);(0,s.useEffect)(()=>{i(document.documentElement.classList.contains("dark"));let e=new MutationObserver(()=>{i(document.documentElement.classList.contains("dark"))});return e.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>e.disconnect()},[]);let n=(0,s.useMemo)(()=>t?Object.entries(t).sort((e,t)=>t[1]-e[1]).slice(0,7):[],[t]),o=(0,s.useMemo)(()=>({labels:n.map(e=>{let[t]=e;return"Direct"===t?"Direct Traffic":t.length>30?"".concat(t.substring(0,27),"..."):t}),datasets:[{label:"Requests",data:n.map(e=>{let[,t]=e;return t}),backgroundColor:l?"rgba(236, 72, 153, 0.5)":"rgba(236, 72, 153, 0.7)",borderColor:"rgba(236, 72, 153, 1)",borderWidth:2,borderRadius:6,hoverBackgroundColor:"rgba(236, 72, 153, 1)"}]}),[n,l]),d=(0,s.useMemo)(()=>({indexAxis:"y",responsive:!0,maintainAspectRatio:!1,animation:{duration:1200,easing:"easeOutQuart"},plugins:{legend:{display:!1},tooltip:{enabled:!0,backgroundColor:l?"rgba(17, 24, 39, 0.9)":"rgba(255, 255, 255, 0.9)",titleColor:l?"#F9FAFB":"#111827",bodyColor:l?"#D1D5DB":"#374151",borderColor:l?"rgba(209, 213, 219, 0.2)":"rgba(0, 0, 0, 0.1)",borderWidth:1,padding:15,cornerRadius:12,displayColors:!1,callbacks:{title:e=>{if(n.length>0){let t=n[e[0].dataIndex][0];return"Referrer: ".concat(t)}return""},label:e=>"Requests: ".concat(e.raw.toLocaleString())}}},scales:{y:{grid:{display:!1},ticks:{color:l?"#9ca3af":"#6b7280",font:{size:10}}},x:{beginAtZero:!0,grid:{color:l?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.05)",display:!1},border:{display:!1},ticks:{color:l?"#9ca3af":"#6b7280"}}}}),[l,n]);return t&&0!==Object.keys(t).length?(0,r.jsxs)("div",{className:a,children:[(0,r.jsxs)("div",{className:"p-6 pb-4 border-b border-gray-200/50 dark:border-gray-700/50",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center space-x-2",children:[(0,r.jsx)($.A,{className:"h-5 w-5 text-pink-500"}),(0,r.jsx)("span",{children:"Top Referring URLs"})]}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Top sources driving traffic to your site."})]}),(0,r.jsx)("div",{className:"p-6 space-y-6",children:(0,r.jsx)("div",{className:"h-[200px] sm:h-[250px] relative",children:(0,r.jsx)(h.yP,{data:o,options:d})})})]}):(0,r.jsx)("div",{className:"p-8 ".concat(a),children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)($.A,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"No Referrer Data"})]})})};var et=a(8813);b.t1.register(b.PP,b.kc,b.E8,b.hE,b.m_,b.s$);let ea=function(e){let{data:t,className:a=""}=e,[l,i]=(0,s.useState)(!1);(0,s.useEffect)(()=>{i(document.documentElement.classList.contains("dark"));let e=new MutationObserver(()=>{i(document.documentElement.classList.contains("dark"))});return e.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>e.disconnect()},[]);let n=(0,s.useMemo)(()=>t?Object.entries(t).sort((e,t)=>t[1]-e[1]).slice(0,7):[],[t]),o=(0,s.useMemo)(()=>({labels:n.map(e=>{let[t]=e;return t.length>30?"".concat(t.substring(0,27),"..."):t}),datasets:[{label:"Requests",data:n.map(e=>{let[,t]=e;return t}),backgroundColor:l?"rgba(34, 197, 94, 0.5)":"rgba(34, 197, 94, 0.7)",borderColor:"rgba(34, 197, 94, 1)",borderWidth:2,borderRadius:6,hoverBackgroundColor:"rgba(34, 197, 94, 1)"}]}),[n,l]),d=(0,s.useMemo)(()=>({indexAxis:"y",responsive:!0,maintainAspectRatio:!1,animation:{duration:1200,easing:"easeOutQuart"},plugins:{legend:{display:!1},tooltip:{enabled:!0,backgroundColor:l?"rgba(17, 24, 39, 0.9)":"rgba(255, 255, 255, 0.9)",titleColor:l?"#F9FAFB":"#111827",bodyColor:l?"#D1D5DB":"#374151",borderColor:l?"rgba(209, 213, 219, 0.2)":"rgba(0, 0, 0, 0.1)",borderWidth:1,padding:15,cornerRadius:12,displayColors:!1,callbacks:{title:e=>{if(n.length>0){let t=n[e[0].dataIndex][0];return"URL: ".concat(t)}return""},label:e=>"Requests: ".concat(e.raw.toLocaleString())}}},scales:{y:{grid:{display:!1},ticks:{color:l?"#9ca3af":"#6b7280",font:{size:10}}},x:{beginAtZero:!0,grid:{color:l?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.05)"},ticks:{color:l?"#9ca3af":"#6b7280"},border:{display:!1}}}}),[l,n]);return t&&0!==Object.keys(t).length?(0,r.jsxs)("div",{className:a,children:[(0,r.jsxs)("div",{className:"p-6 pb-4 border-b border-gray-200/50 dark:border-gray-700/50",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center space-x-2",children:[(0,r.jsx)(et.A,{className:"h-5 w-5 text-green-500"}),(0,r.jsx)("span",{children:"Top Requested URLs"})]}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Most frequently accessed URLs."})]}),(0,r.jsx)("div",{className:"p-6 space-y-6",children:(0,r.jsx)("div",{className:"h-[200px] sm:h-[250px] relative",children:(0,r.jsx)(h.yP,{data:o,options:d})})})]}):(0,r.jsx)("div",{className:"p-8 ".concat(a),children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(et.A,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"No URL Data"})]})})};var er=a(8710),es=a(4829),el=a(3290),ei=a(257),en=a(7320),eo=a(9103),ed=a(3310),ec=a(879);function ex(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,ec.QP)((0,ed.$)(t))}let eg=eo.bL;eo.l9;let em=eo.ZL;eo.bm;let eu=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(eo.hJ,{ref:t,className:ex("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s})});eu.displayName=eo.hJ.displayName;let eh=s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.jsxs)(em,{children:[(0,r.jsx)(eu,{}),(0,r.jsxs)(eo.UC,{ref:t,className:ex("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l,children:[s,(0,r.jsxs)(eo.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(f.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});eh.displayName=eo.UC.displayName;let ep=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:ex("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};ep.displayName="DialogHeader";let eb=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(eo.hE,{ref:t,className:ex("text-lg font-semibold leading-none tracking-tight",a),...s})});eb.displayName=eo.hE.displayName;let ey=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(eo.VY,{ref:t,className:ex("text-sm text-muted-foreground",a),...s})});ey.displayName=eo.VY.displayName;let ef=function(e){let{data:t,parsedLines:a,className:n=""}=e,[o,d]=(0,s.useState)(null),[c,m]=(0,s.useState)(!1),u=(0,s.useMemo)(()=>Object.entries(t).sort((e,t)=>t[1].attackCount-e[1].attackCount).slice(0,10),[t]),h=(0,s.useMemo)(()=>o?a.filter(e=>e.ipAddress===o&&e.attackType):[],[o,a]);if(!t||0===Object.keys(t).length)return(0,r.jsxs)("div",{className:"".concat(n," bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200/50 dark:border-gray-700/50 overflow-hidden"),children:[(0,r.jsxs)("div",{className:"px-6 py-6 pb-4 border-b border-gray-200/50 dark:border-gray-700/50",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center space-x-2",children:[(0,r.jsx)(g.A,{className:"h-5 w-5 text-yellow-500"}),(0,r.jsx)("span",{children:"Top Suspicious IP Addresses"})]}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"IP addresses with detected attack attempts"})]}),(0,r.jsx)("div",{className:"p-8",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:(0,r.jsx)(x.A,{className:"h-8 w-8 text-gray-400"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No Suspicious IPs Detected"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"No suspicious activity found in the analyzed logs."})]})})]});let p=e=>{try{let t=e.match(/(\d{2})\/(\w{3})\/(\d{4}):(\d{2}):(\d{2}):(\d{2})/);if(t){let[,e,a,r,s,l]=t;return"".concat(a,"/").concat(e," ").concat(s,":").concat(l)}return e}catch(t){return e}},b={hidden:{y:10,opacity:0},visible:{y:0,opacity:1}};return(0,r.jsxs)("div",{className:n,children:[(0,r.jsxs)("div",{className:"px-6 py-6 pb-4 border-b border-gray-200/50 dark:border-gray-700/50",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center space-x-2",children:[(0,r.jsx)(g.A,{className:"h-5 w-5 text-yellow-500"}),(0,r.jsx)("span",{children:"Top Suspicious IP Addresses"})]}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"IP addresses with detected attack attempts"})]}),(0,r.jsx)("div",{className:"px-6 py-6",children:(0,r.jsx)("div",{className:"flex flex-col space-y-4",children:(0,r.jsx)(l.P.div,{className:"flex flex-col mt-2 space-y-4",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},initial:"hidden",animate:"visible",children:u.map((e,t)=>{let[a,s]=e;return(0,r.jsxs)(l.P.div,{variants:b,className:"p-5 rounded-xl border border-gray-200 dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-all duration-200 shadow-sm hover:shadow-md",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-gradient-to-br from-yellow-400 to-orange-500 flex items-center justify-center text-white font-bold",children:t+1}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("h3",{className:"font-bold text-lg text-gray-900 dark:text-white break-all",children:a}),(0,r.jsx)("a",{href:"https://whois.domaintools.com/".concat(a),target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",title:"View WHOIS information",children:(0,r.jsx)(er.A,{className:"h-4 w-4"})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1 mt-1",children:[(0,r.jsx)(U.A,{className:"h-4 w-4 text-gray-500 dark:text-gray-400"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:p(s.lastSeen)})]})]})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-r from-red-500 to-orange-500 px-4 py-2 rounded-lg flex items-center self-start shadow cursor-pointer",onClick:()=>{d(a),m(!0)},children:[(0,r.jsx)(g.A,{className:"h-5 w-5 text-white mr-2"}),(0,r.jsxs)("span",{className:"text-sm font-bold text-white",children:[s.attackCount," attack",1!==s.attackCount?"s":""]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-5 pt-5 border-t border-gray-200/50 dark:border-gray-700/50",children:[(0,r.jsxs)("div",{className:"flex items-center min-w-0 bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg",children:[(0,r.jsx)("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-2 rounded-lg mr-3",children:(0,r.jsx)(i.A,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:"Total Requests"}),(0,r.jsx)("p",{className:"font-semibold text-gray-900 dark:text-white truncate text-lg",children:s.requestCount.toLocaleString()})]})]}),(0,r.jsxs)("div",{className:"flex items-center min-w-0 bg-purple-50 dark:bg-purple-900/20 p-3 rounded-lg",children:[(0,r.jsx)("div",{className:"bg-purple-100 dark:bg-purple-900/30 p-2 rounded-lg mr-3",children:(0,r.jsx)(es.A,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:"Unique Paths"}),(0,r.jsx)("p",{className:"font-semibold text-gray-900 dark:text-white truncate text-lg",children:s.uniquePaths})]})]}),(0,r.jsxs)("div",{className:"flex items-center min-w-0 bg-green-50 dark:bg-green-900/20 p-3 rounded-lg",children:[(0,r.jsx)("div",{className:"bg-green-100 dark:bg-green-900/30 p-2 rounded-lg mr-3",children:(0,r.jsx)(el.A,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:"User Agents"}),(0,r.jsx)("p",{className:"font-semibold text-gray-900 dark:text-white truncate text-lg",children:s.uniqueUserAgents})]})]}),(0,r.jsxs)("div",{className:"flex items-center min-w-0 bg-amber-50 dark:bg-amber-900/20 p-3 rounded-lg",children:[(0,r.jsx)("div",{className:"bg-amber-100 dark:bg-amber-900/30 p-2 rounded-lg mr-3",children:(0,r.jsx)(ei.A,{className:"h-5 w-5 text-amber-600 dark:text-amber-400"})}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:"Bandwidth"}),(0,r.jsx)("p",{className:"font-semibold text-gray-900 dark:text-white truncate text-lg",children:(e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]})(s.bandwidthUsage)})]})]})]}),(0,r.jsx)("div",{className:"mt-5 pt-5 border-t border-gray-200/50 dark:border-gray-700/50",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,r.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center",children:[(0,r.jsx)(en.A,{className:"h-4 w-4 mr-1.5"}),"HTTP Methods"]}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(s.methods).map(e=>{let[t,a]=e;return(0,r.jsxs)("span",{className:"px-3 py-1.5 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm font-medium",children:[t," ",(0,r.jsxs)("span",{className:"font-normal text-gray-500",children:["(",a,")"]})]},t)})})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,r.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center",children:[(0,r.jsx)(i.A,{className:"h-4 w-4 mr-1.5"}),"Status Codes"]}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(s.statusCodes).map(e=>{let[t,a]=e,s="bg-gray-100 dark:bg-gray-700";return t.startsWith("2")&&(s="bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200"),t.startsWith("4")&&(s="bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200"),t.startsWith("5")&&(s="bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200"),(0,r.jsxs)("span",{className:"px-3 py-1.5 rounded-lg text-sm font-medium ".concat(s),children:[t," ",(0,r.jsxs)("span",{className:"font-normal",children:["(",a,")"]})]},t)})})]})]})})]},a)})})})}),(0,r.jsx)(eg,{open:c,onOpenChange:m,children:(0,r.jsxs)(eh,{className:"max-w-4xl",children:[(0,r.jsxs)(ep,{children:[(0,r.jsxs)(eb,{children:["Attack Logs for ",o]}),(0,r.jsx)(ey,{children:"Showing all detected attack logs for this IP address."})]}),(0,r.jsx)("div",{className:"max-h-[60vh] overflow-y-auto",children:(0,r.jsxs)("table",{className:"w-full text-sm text-left text-gray-500 dark:text-gray-400",children:[(0,r.jsx)("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col",className:"px-6 py-3",children:"Timestamp"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3",children:"Method"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3",children:"Path"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3",children:"Status"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3",children:"Attack Type"})]})}),(0,r.jsx)("tbody",{children:h.map((e,t)=>(0,r.jsxs)("tr",{className:"bg-white border-b dark:bg-gray-800 dark:border-gray-700",children:[(0,r.jsx)("td",{className:"px-6 py-4",children:p(e.timestamp)}),(0,r.jsx)("td",{className:"px-6 py-4",children:e.method}),(0,r.jsx)("td",{className:"px-6 py-4 break-all",children:e.path}),(0,r.jsx)("td",{className:"px-6 py-4",children:e.status}),(0,r.jsx)("td",{className:"px-6 py-4",children:e.attackType})]},t))})]})})]})})]})},ev=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a={requestStats:{totalRequests:0,uniqueIPs:new Set,totalAttackAttempts:0,parseErrors:0},httpMethods:{},statusCodes:{"2xx":0,"3xx":0,"4xx":0,"5xx":0},attackDistribution:{"SQL Injection":0,XSS:0,"Command Injection":0,"Directory Traversal":0,"Brute Force":0},trafficOverTime:Array(24).fill(0).map((e,t)=>({hour:t,count:0})),recentAttacks:[],ipStats:{requestCounts:{},attackCounts:{},statusCodes:{},methods:{},bandwidthUsage:{},lastSeen:{},userAgents:{},paths:{}},referrerCounts:{},requestedUrlCounts:{}},r=0;e.forEach((e,s)=>{var l;let i=!0;for(let[a,r]of Object.entries(t))if(r){if("status"===a){let t=(null==(l=e.status)?void 0:l.toString())||"";if("string"==typeof r&&r.endsWith("xx")){let e=r.slice(0,1);if(!t.startsWith(e)){i=!1;break}}else if(t!==r.toString()){i=!1;break}}else if("ipAddress"===a){if(e.ipAddress!==r){i=!1;break}}else if("method"===a){if(!e.method||e.method.toLowerCase()!==r.toLowerCase()){i=!1;break}}else if(e[a]!==r){i=!1;break}}if(!i)return void console.log("Line ".concat(s," filtered out"));let{ipAddress:n,remoteUser:o,timestamp:d,method:c,path:x,status:g,bodyBytesSent:m,referer:u,userAgent:h,attackType:p}=e;if(!n||!c||!g)return void console.log("Line ".concat(s," missing required fields, skipping"));r++,a.ipStats.requestCounts[n]||(a.ipStats.requestCounts[n]=0,a.ipStats.attackCounts[n]=0,a.ipStats.statusCodes[n]={"2xx":0,"3xx":0,"4xx":0,"5xx":0},a.ipStats.methods[n]={},a.ipStats.bandwidthUsage[n]=0,a.ipStats.userAgents[n]=new Set,a.ipStats.paths[n]=new Set);let b=parseInt(m,10)||0;a.ipStats.requestCounts[n]++,a.ipStats.bandwidthUsage[n]+=b,a.ipStats.lastSeen[n]=d,a.ipStats.paths[n].add(x),a.ipStats.methods[n][c]=(a.ipStats.methods[n][c]||0)+1;let y="".concat(g[0],"xx");a.ipStats.statusCodes[n]&&void 0!==a.ipStats.statusCodes[n][y]&&a.ipStats.statusCodes[n][y]++,h&&a.ipStats.userAgents[n].add(h),u&&"-"!==u&&(a.referrerCounts[u]=(a.referrerCounts[u]||0)+1),a.requestStats.totalRequests++,a.requestStats.uniqueIPs.add(n),a.httpMethods[c]=(a.httpMethods[c]||0)+1,void 0!==a.statusCodes[y]&&a.statusCodes[y]++,a.requestedUrlCounts[x]=(a.requestedUrlCounts[x]||0)+1;try{let[e,t]=d.replace(/^\[|\]$/g,"").split(" ");if(e){let[t,r]=e.split(":");if(t&&r){let[e,s,l]=t.split("/"),i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].findIndex(e=>e===s);if(-1!==i){let e=parseInt(r.split(":")[0],10);!isNaN(e)&&e>=0&&e<24?a.trafficOverTime[e].count++:console.warn("Invalid hour in timestamp:",d,"Hour:",e)}else console.warn("Invalid month in timestamp:",d,"Month:",s)}else console.warn("Could not split datetime part into date and time:",e)}else console.warn("No datetime part found in timestamp:",d)}catch(e){console.error("Error parsing timestamp:",d,e)}p&&(console.log("ATTACK COUNTING SECTION REACHED for:",p),console.log("Aggregator found attack:",p,"for line:",{ipAddress:n,method:c,path:x,attackType:p}),a.attackDistribution[p]++,a.requestStats.totalAttackAttempts++,a.ipStats.attackCounts[n]++,a.recentAttacks.push({timestamp:d,ipAddress:n,remoteUser:o,attackType:p,requestPath:x}))});let s=a.trafficOverTime.map((e,t)=>({hour:t,count:e.count}));return{requestStats:{...a.requestStats,uniqueIPs:a.requestStats.uniqueIPs.size},httpMethods:a.httpMethods,statusCodes:a.statusCodes,attackDistribution:a.attackDistribution,trafficOverTime:s,topIp:Object.fromEntries(Object.entries(a.ipStats.requestCounts).sort((e,t)=>{let[,a]=e,[,r]=t;return r-a}).slice(0,10)),topReferrers:Object.fromEntries(Object.entries(a.referrerCounts).sort((e,t)=>{let[,a]=e,[,r]=t;return r-a}).slice(0,10)),topRequestedUrls:Object.fromEntries(Object.entries(a.requestedUrlCounts).sort((e,t)=>{let[,a]=e,[,r]=t;return r-a}).slice(0,10)),suspiciousIps:Object.entries(a.ipStats.attackCounts).filter(e=>{let[,t]=e;return t>0}).sort((e,t)=>{let[,a]=e,[,r]=t;return r-a}).reduce((e,t)=>{var r,s;let[l,i]=t;return e[l]={attackCount:i,requestCount:a.ipStats.requestCounts[l],lastSeen:a.ipStats.lastSeen[l],uniquePaths:(null==(r=a.ipStats.paths[l])?void 0:r.size)||0,uniqueUserAgents:(null==(s=a.ipStats.userAgents[l])?void 0:s.size)||0,bandwidthUsage:a.ipStats.bandwidthUsage[l],methods:a.ipStats.methods[l],statusCodes:a.ipStats.statusCodes[l]},e},{}),recentAttacks:a.recentAttacks.slice(-100).reverse()}},ej=(0,s.memo)(function(e){let{data:t=[],className:a=""}=e,[n,o]=(0,s.useState)("hourly"),[d,c]=(0,s.useState)(!1),[x,g]=(0,s.useState)(!1);(0,s.useEffect)(()=>{c(!0)},[]);let u=(0,s.useMemo)(()=>{if(!t.length)return{labels:[],dataPoints:[],totalRequests:0,peakTime:"N/A",peakValue:0,avgRequests:0,trend:"stable"};let e=[],a=[],r=0;if("hourly"===n){let s=[...t].sort((e,t)=>e.hour-t.hour);e=s.map(e=>{let t=e.hour;return"".concat(0===t?12:t>12?t-12:t,":00 ").concat(t<12?"AM":"PM")}),a=s.map(e=>e.count),r=s.reduce((e,t)=>e+t.count,0)}else{let s=[,,,,].fill(0);t.forEach(e=>{let t=Math.floor(e.hour/6);t>=0&&t<4&&(s[t]+=e.count)}),e=["00:00 - 05:59","06:00 - 11:59","12:00 - 17:59","18:00 - 23:59"],a=s,r=s.reduce((e,t)=>e+t,0)}let s=Math.max(...a),l=e[a.indexOf(s)]||"N/A",i=a.length>0?Math.round(r/a.length):0,o=a.slice(0,Math.floor(a.length/2)),d=a.slice(Math.floor(a.length/2)),c=o.reduce((e,t)=>e+t,0)/o.length,x=d.reduce((e,t)=>e+t,0)/d.length;return{labels:e,dataPoints:a,totalRequests:r,peakTime:l,peakValue:s,avgRequests:i,trend:x>1.1*c?"increasing":x<.9*c?"decreasing":"stable"}},[t,n]),p=(0,s.useCallback)(()=>{g(!0),setTimeout(()=>{o(e=>"hourly"===e?"intervals":"hourly"),g(!1)},200)},[]),b=(0,s.useMemo)(()=>({labels:u.labels,datasets:[{label:"Traffic Volume (".concat("hourly"===n?"Hourly":"6-Hour Periods",")"),data:u.dataPoints,borderColor:"rgb(59, 130, 246)",backgroundColor:d?e=>{let{ctx:t,chartArea:a}=e.chart;if(!a)return"rgba(59, 130, 246, 0.1)";let r=t.createLinearGradient(0,a.bottom,0,a.top);return r.addColorStop(0,"rgba(59, 130, 246, 0.05)"),r.addColorStop(.5,"rgba(59, 130, 246, 0.15)"),r.addColorStop(1,"rgba(59, 130, 246, 0.3)"),r}:"rgba(59, 130, 246, 0.1)",tension:.4,fill:!0,pointRadius:4,pointHoverRadius:8,pointBackgroundColor:"rgb(59, 130, 246)",pointBorderColor:"#ffffff",pointBorderWidth:2,borderWidth:3,pointHoverBackgroundColor:"rgb(37, 99, 235)",pointHoverBorderColor:"#ffffff",pointHoverBorderWidth:2}]}),[u.labels,u.dataPoints,n,d]),y=(0,s.useMemo)(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{mode:"index",intersect:!1,backgroundColor:"rgba(17, 24, 39, 0.95)",titleColor:"#F9FAFB",bodyColor:"#F9FAFB",borderColor:"rgba(59, 130, 246, 0.5)",borderWidth:1,padding:12,cornerRadius:8,displayColors:!1,titleFont:{size:14,weight:600},bodyFont:{size:13},callbacks:{title:e=>"Time: ".concat(e[0].label),label:e=>{let t=e.parsed.y||0,a=(t/u.totalRequests*100).toFixed(1);return["Requests: ".concat(t.toLocaleString()),"Share: ".concat(a,"% of total traffic")]}}}},scales:{y:{beginAtZero:!0,grid:{color:"rgba(156, 163, 175, 0.2)",drawBorder:!1},border:{display:!1},ticks:{color:"#6B7280",font:{size:12},callback:e=>Number(e).toLocaleString()}},x:{grid:{display:!1},border:{display:!1},ticks:{color:"#6B7280",font:{size:12},maxRotation:45,autoSkip:!0,maxTicksLimit:"hourly"===n?12:4}}},animation:{duration:1e3,easing:"easeInOutQuart"},interaction:{mode:"nearest",axis:"x",intersect:!1}}),[u.totalRequests,n]),f=[{title:"Peak Time",value:u.peakTime,icon:U.A,color:"blue",subtitle:"".concat(u.peakValue.toLocaleString()," requests")},{title:"Average",value:u.avgRequests.toLocaleString(),icon:T.A,color:"green",subtitle:"per ".concat("hourly"===n?"hour":"interval")},{title:"Total Volume",value:u.totalRequests.toLocaleString(),icon:i.A,color:"purple",subtitle:"requests processed"},{title:"Trend",value:"increasing"===u.trend?"Rising":"decreasing"===u.trend?"Declining":"Stable",icon:"increasing"===u.trend?m.A:"decreasing"===u.trend?H.A:j.A,color:"increasing"===u.trend?"green":"decreasing"===u.trend?"red":"gray",subtitle:"traffic pattern"}];return t.length?(0,r.jsx)(l.P.div,{initial:{opacity:0,scale:.9,rotateX:-10,rotateY:-5},animate:{opacity:1,scale:1,rotateX:0,rotateY:0},transition:{type:"spring",stiffness:120,damping:18,mass:1.2,duration:.8},className:"bg-white/60 dark:bg-gray-800/60 backdrop-blur-sm rounded-2xl ".concat(a),children:(0,r.jsxs)(l.P.div,{variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.12,delayChildren:.15}}},initial:"hidden",animate:"visible",className:"h-full",children:[(0,r.jsx)("div",{className:"p-6 pb-4 border-b border-gray-200/50 dark:border-gray-700/50",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,r.jsxs)(l.P.div,{variants:{hidden:{opacity:0,y:20,rotateX:10},visible:{opacity:1,y:0,rotateX:0,transition:{type:"spring",stiffness:100,damping:15,mass:.8}}},children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center space-x-2",children:[(0,r.jsx)(T.A,{className:"h-5 w-5 text-blue-500"}),(0,r.jsx)("span",{children:"Traffic Timeline Analysis"})]}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"hourly"===n?"Hourly request distribution patterns":"Traffic volume across 6-hour time periods"})]}),(0,r.jsxs)(l.P.div,{className:"flex items-center space-x-3",variants:{hidden:{opacity:0,y:20,rotateX:10},visible:{opacity:1,y:0,rotateX:0,transition:{type:"spring",stiffness:100,damping:15,mass:.8,delay:.05}}},children:[(0,r.jsx)(W.A,{className:"h-4 w-4 text-gray-500"}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Hourly"}),(0,r.jsx)("button",{onClick:p,disabled:x,className:"relative inline-flex h-6 w-11 items-center rounded-full transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ".concat("hourly"===n?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"," ").concat(x?"opacity-50 cursor-not-allowed":"cursor-pointer"),children:(0,r.jsx)(l.P.span,{className:"inline-block h-4 w-4 transform rounded-full bg-white shadow-md",animate:{x:"hourly"===n?2:22},transition:{type:"spring",stiffness:500,damping:30}})}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Intervals"})]})]})}),(0,r.jsx)("div",{className:"p-6 pb-4",children:(0,r.jsx)(l.P.div,{className:"relative h-80 mb-6",variants:{hidden:{opacity:0,scale:.95,rotateZ:-2},visible:{opacity:1,scale:1,rotateZ:0,transition:{type:"spring",stiffness:100,damping:18,mass:1,delay:.1}}},children:(0,r.jsx)(l.P.div,{initial:{opacity:0,scale:.98,rotateZ:-.5},animate:{opacity:1,scale:1,rotateZ:0},transition:{type:"spring",stiffness:120,damping:18,mass:.7,duration:.6},className:"w-full h-full",children:(0,r.jsx)(h.N1,{data:b,options:y})},n)})}),(0,r.jsx)("div",{className:"p-6 pt-0",children:(0,r.jsx)(l.P.div,{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.08,delayChildren:.2}}},children:f.map((e,t)=>{let a=e.icon;return(0,r.jsxs)(l.P.div,{variants:{hidden:{opacity:0,scale:.85,rotateX:-15,rotateY:-15,y:30},visible:{opacity:1,scale:1,rotateX:0,rotateY:0,y:0,transition:{type:"spring",stiffness:180,damping:20,mass:.9,delay:.05*t}}},whileHover:{y:-8,rotateZ:3,transition:{type:"spring",stiffness:400,damping:15}},className:"p-4 rounded-xl border transition-all duration-200 hover:shadow-md ".concat({blue:"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-800/50",green:"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 border-green-200 dark:border-green-800/50",purple:"bg-purple-50 dark:bg-purple-900/20 text-purple-700 dark:text-purple-300 border-purple-200 dark:border-purple-800/50",red:"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 border-red-200 dark:border-red-800/50",gray:"bg-gray-50 dark:bg-gray-900/20 text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-800/50"}[e.color]),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)(a,{className:"h-4 w-4 opacity-70"}),(0,r.jsxs)(l.P.div,{className:"text-xs font-medium opacity-60",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.4+.05*t},children:["#",t+1]})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(l.P.dt,{className:"text-xs font-semibold uppercase tracking-wide opacity-80",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.2+.05*t},children:e.title}),(0,r.jsx)(l.P.dd,{className:"text-lg font-bold",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.25+.05*t},children:e.value}),(0,r.jsx)(l.P.p,{className:"text-xs opacity-60",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3+.05*t},children:e.subtitle})]})]},e.title)})})})]})}):(0,r.jsx)(l.P.div,{initial:{opacity:0,scale:.9,rotateX:-10,rotateY:-5},animate:{opacity:1,scale:1,rotateX:0,rotateY:0},transition:{type:"spring",stiffness:120,damping:18,mass:1.2,duration:.8},className:"bg-white/60 dark:bg-gray-800/60 backdrop-blur-sm rounded-2xl border border-gray-200 dark:border-gray-700/50 p-8 ".concat(a),children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(l.P.div,{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",initial:{opacity:0,scale:.5,rotate:-25,rotateX:-20},animate:{opacity:1,scale:1,rotate:0,rotateX:0},transition:{type:"spring",stiffness:180,damping:15,mass:.9,delay:.2},children:(0,r.jsx)(T.A,{className:"h-8 w-8 text-gray-400"})}),(0,r.jsx)(l.P.h3,{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:100,damping:15,delay:.3},children:"No Traffic Data"}),(0,r.jsx)(l.P.p,{className:"text-gray-600 dark:text-gray-400",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:100,damping:15,delay:.4},children:"Upload log files to see traffic patterns over time."})]})})});function eN(e){let{stats:t=null,parsedLines:a=[]}=e,[o,d]=(0,s.useState)({}),c=(0,s.useCallback)((e,t)=>{d(a=>{let r={...a};return null==t?delete r[e]:r[e]=t,r})},[]),{requestStats:x,httpMethods:g,statusCodes:m,attackDistribution:h,trafficOverTime:p,recentAttacks:b,topIp:y,topReferrers:f,topRequestedUrls:v,suspiciousIps:j}=(0,s.useMemo)(()=>{if(0===Object.keys(o).length)return t;let e=a.filter(e=>Object.entries(o).every(t=>{let[a,r]=t;if(!r)return!0;if("status"===a){if("string"==typeof r&&r.endsWith("xx")){let t=r.slice(0,1);return e.status&&e.status.toString().startsWith(t)}return e.status&&e.status.toString()===r.toString()}return"ipAddress"===a?e.ipAddress===r:"method"===a?e.method&&e.method.toLowerCase()===r.toLowerCase():"attackType"===a?e.attackType===r:e[a]===r}));o.attackType;let r=ev(e,o);return o.attackType&&(null==t?void 0:t.attackDistribution)?{...r,attackDistribution:t.attackDistribution}:r},[o,a,JSON.stringify(t)])||{},N=(0,s.useMemo)(()=>null!==t&&t.requestStats&&t.requestStats.totalRequests>0,[t]),k=(0,s.useMemo)(()=>["SQL Injection","XSS","Command Injection","Directory Traversal","Brute Force"],[]);if(!N)return(0,r.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-center min-h-[400px]",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(i.A,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"No Data Available"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Upload a log file to begin analysis."})]})});let w={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl md:text-3xl font-bold text-gray-900 dark:text-white",children:"Log Analytics Dashboard"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Comprehensive analysis of your server logs"})]})}),Object.keys(o).length>0&&(0,r.jsxs)(l.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Filters Active:"}),(0,r.jsx)("div",{className:"flex gap-2 flex-wrap",children:Object.entries(o).map(e=>{let[t,a]=e;return(0,r.jsxs)("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200 text-xs font-medium rounded-full",children:[t,": ",a]},t)})})]}),(0,r.jsx)("button",{onClick:()=>{d({})},className:"p-1 text-blue-600 dark:text-blue-300 hover:bg-blue-100 dark:hover:bg-blue-800/50 rounded-full",children:(0,r.jsx)(n.A,{className:"w-5 h-5"})})]}),(0,r.jsxs)(l.P.div,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-12 gap-6",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"visible",children:[(0,r.jsx)(l.P.div,{className:"lg:col-span-12",variants:w,children:(0,r.jsx)(u,{data:x?{...x,suspiciousIps:j?Object.keys(j).length:0,totalAttackAttempts:(null==b?void 0:b.length)||0}:void 0})}),(0,r.jsx)(l.P.div,{className:"lg:col-span-12",variants:w,children:(0,r.jsx)(ej,{data:p||[]},JSON.stringify(o))}),(0,r.jsx)(l.P.div,{className:"md:col-span-1 lg:col-span-6",variants:w,children:(0,r.jsx)(C,{data:g||{},parsedLines:a,onFilter:c,activeFilter:null==o?void 0:o.method})}),(0,r.jsx)(l.P.div,{className:"md:col-span-1 lg:col-span-6",variants:w,children:(0,r.jsx)(E,{data:m||{},parsedLines:a,onFilter:c,activeFilter:null==o?void 0:o.status})}),(0,r.jsx)(l.P.div,{className:"md:col-span-1 lg:col-span-6",variants:w,children:(0,r.jsx)(O,{data:h||{},allAttackTypes:k,onFilter:c,activeFilter:null==o?void 0:o.attackType})}),(0,r.jsx)(l.P.div,{className:"md:col-span-1 lg:col-span-6",variants:w,children:(0,r.jsx)(Q,{data:y||{},suspiciousIps:j||{},onFilter:c,activeFilter:null==o?void 0:o.ipAddress})}),(0,r.jsx)(l.P.div,{className:"md:col-span-1 lg:col-span-6",variants:w,children:(0,r.jsx)(ea,{data:v||{}})}),(0,r.jsx)(l.P.div,{className:"md:col-span-1 lg:col-span-6",variants:w,children:(0,r.jsx)(ee,{data:f||{}})}),(0,r.jsx)(l.P.div,{className:"lg:col-span-12",variants:w,children:(0,r.jsx)(ef,{data:j||{},parsedLines:a})}),(0,r.jsx)(l.P.div,{className:"lg:col-span-12",variants:w,children:(0,r.jsx)(J,{data:b||[]})})]})]})}var ek=a(7825),ew=a(6292);function eC(e){let{isDarkMode:t,toggleDarkMode:a}=e;return(0,r.jsxs)(l.P.button,{onClick:a,className:"relative p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 overflow-hidden","aria-label":t?"Switch to light mode":"Switch to dark mode",whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,r.jsx)(p.N,{mode:"wait",initial:!1,children:(0,r.jsx)(l.P.div,{initial:{y:-30,opacity:0},animate:{y:0,opacity:1},exit:{y:30,opacity:0},transition:{duration:.2,ease:"easeInOut"},className:"w-5 h-5 flex items-center justify-center",children:t?(0,r.jsx)(ek.A,{size:20,className:"text-yellow-300"}):(0,r.jsx)(ew.A,{size:20,className:"text-gray-700"})},t?"sun":"moon")}),(0,r.jsx)(l.P.div,{className:"absolute inset-0 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 dark:from-blue-600 dark:to-purple-700 opacity-0 dark:opacity-0",initial:{opacity:0},animate:{opacity:.1*!!t,transition:{duration:.6,ease:"easeInOut"}}})]})}var eS=a(5163),eA=a(2407),eP=a(4398),eT=a(4325),eR=a(8584);function eL(e){let{onLogParsed:t}=e,[i,n]=(0,s.useState)("file"),[o,d]=(0,s.useState)(!1),[c,x]=(0,s.useState)(!1),[g,m]=(0,s.useState)(0),[u,h]=(0,s.useState)(""),[b,y]=(0,s.useState)(!1),[f,v]=(0,s.useState)(""),[j,N]=(0,s.useState)(""),[k,w]=(0,s.useState)(""),C=(0,s.useRef)(null),S=/^(\S+)\s+-\s+-\s+\[(.*?)\]\s+"(GET|POST|PUT|DELETE|HEAD|OPTIONS|PATCH)\s+.*?\s+HTTP\/\d+\.\d+"\s+\d{3}\s+\d+\s+"[^"]*"\s+"[^"]*"/,P=/^(\S+)\s+\S+\s+\S+\s+\[([^\]]+)\]\s+"(GET|POST|PUT|DELETE|HEAD|OPTIONS|PATCH)\s+([^\s"]+)[^"]*"\s+(\d{3})\s+(\d+|-)/,T=e=>{if(!e)return null;let t=e.toString().split("\n").filter(e=>e.trim()).slice(0,5),a=0,r=0;return(t.forEach(e=>{S.test(e)&&a++,P.test(e)&&r++}),0===a&&0===r)?null:a>=r?"Detected Nginx Log":"Detected Apache Http Log"},R=(e,r)=>{let s=new Worker(a.tu(new URL(a.p+a.u(449),a.b)));s.onmessage=e=>{e.data.error?(h(e.data.error),d(!1),N("")):e.data.progress?m(e.data.progress):(m(100),setTimeout(()=>{t(e.data),d(!1),N("")},2e3))},s.postMessage({logContent:e,format:r})},L=(0,s.useCallback)(e=>{let t=e[0];if(t){let e=new FileReader;e.onload=e=>{if(e.target){let t=e.target.result;x(!0),h(""),setTimeout(()=>{let e=T(t);if(!e){h("This file doesn't appear to be a valid Nginx or Apache Http log. Please check the format and try again."),x(!1);return}N(e),setTimeout(()=>{x(!1),d(!0),R(t,e.includes("Nginx")?"nginx":"apache")},1500)},1500)}},e.readAsText(t)}},[t]),{getRootProps:E,getInputProps:q,isDragActive:M}=(0,eS.VB)({onDrop:L,accept:{"text/plain":[".log",".txt"]},onDragEnter:()=>y(!0),onDragLeave:()=>y(!1),onDropAccepted:()=>y(!1)}),D=async e=>{if(e.preventDefault(),!f)return void h("Please enter a valid URL.");h(""),d(!1),N(""),x(!0);try{let e=await fetch(f);if(!e.ok){if(404===e.status)throw Error("File not found at the specified URL.");if(403===e.status)throw Error("Access to the URL is forbidden.");throw Error("Failed to fetch file. Server responded with status: ".concat(e.status))}let t=await e.text();if(!t.trim())throw Error("The fetched file is empty.");let a=T(t);if(!a)throw Error("Could not determine log type. Please ensure it's a valid Nginx or Apache log.");N(a),setTimeout(()=>{x(!1),d(!0),R(t,a.includes("Nginx")?"nginx":"apache")},1500)}catch(t){let e="An unknown error occurred.";t instanceof Error&&(e=t.message),t instanceof TypeError&&t.message.includes("Failed to fetch")&&(e="Failed to fetch the file. This could be a network issue or a CORS policy on the server preventing access."),h(e),x(!1),d(!1)}};return(0,s.useEffect)(()=>{u&&C.current&&C.current.scrollIntoView({behavior:"smooth",block:"center"})},[u]),(0,r.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},className:"space-y-8",children:[(0,r.jsxs)("div",{className:"flex space-x-2 rounded-xl bg-gray-50/50 p-1.5 dark:bg-gray-800/50 backdrop-blur-sm shadow-sm",children:[(0,r.jsxs)("button",{onClick:()=>n("file"),className:"flex flex-1 items-center justify-center space-x-3 rounded-lg px-4 py-3 text-sm font-medium transition-transform duration-300 transform ".concat("file"===i?"bg-white text-blue-600 shadow-md dark:bg-gray-700 dark:text-blue-400 scale-100":"bg-gray-100 text-gray-600 hover:bg-white hover:text-gray-900 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white scale-100 hover:scale-105"),children:[(0,r.jsx)(eA.A,{className:"h-4 w-4 ".concat("file"===i?"text-blue-500":"")}),(0,r.jsx)("span",{children:"Upload File"})]}),(0,r.jsxs)("button",{onClick:()=>n("url"),className:"flex flex-1 items-center justify-center space-x-3 rounded-lg px-4 py-3 text-sm font-medium transition-transform duration-300 transform ".concat("url"===i?"bg-white text-blue-600 shadow-md dark:bg-gray-700 dark:text-blue-400 scale-100":"bg-gray-100 text-gray-600 hover:bg-white hover:text-gray-900 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white scale-100 hover:scale-105"),children:[(0,r.jsx)(eP.A,{className:"h-4 w-4 ".concat("url"===i?"text-blue-500":"")}),(0,r.jsx)("span",{children:"Fetch from URL"})]})]}),(0,r.jsx)(p.N,{children:u&&(0,r.jsx)(l.P.div,{ref:C,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-red-50 dark:bg-red-900/20 px-4 py-3 rounded-lg border border-red-100 dark:border-red-900/30 mx-auto max-w-2xl w-full mb-6",children:(0,r.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,r.jsx)(A.A,{className:"h-5 w-5 text-red-500 dark:text-red-400 mt-0.5 flex-shrink-0"}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-red-700 dark:text-red-300",children:"Failed to load file"}),(0,r.jsx)("div",{className:"text-sm text-red-600 dark:text-red-400 space-y-1",children:u.split("\n").map((e,t)=>(0,r.jsx)("p",{className:t>0?"text-xs opacity-90":"",children:e.replace(/^[â€¢\-]\s*/,"")},t))})]})]})})}),(0,r.jsx)(p.N,{mode:"wait",children:"file"===i?(0,r.jsx)(l.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3},children:(0,r.jsxs)("div",{...E(),className:"relative overflow-hidden rounded-xl border-2 border-dashed p-12 text-center transition-all duration-300\n                ".concat(b?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 shadow-lg":"border-gray-300 dark:border-gray-700 hover:border-gray-400 dark:hover:border-gray-600 hover:shadow-md"," cursor-pointer group"),children:[(0,r.jsx)("input",{...q()}),(0,r.jsxs)("div",{className:"absolute inset-0 opacity-5 dark:opacity-10",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/10 to-purple-500/10"}),(0,r.jsx)("div",{className:"h-full w-full bg-[radial-gradient(circle,_transparent_20%,_#f0f0f0_20%,_#f0f0f0_21%,_transparent_21%,_transparent_50%)] bg-[length:1em_1em] dark:bg-[radial-gradient(circle,_transparent_20%,_#1a1a1a_20%,_#1a1a1a_21%,_transparent_21%,_transparent_50%)]"})]}),c?(0,r.jsx)(eM,{logType:j}):o?(0,r.jsx)(eE,{progress:g,logType:j}):(0,r.jsx)(eq,{isDragActive:M,isDragging:b})]})},"file-upload"):(0,r.jsx)(l.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:(0,r.jsx)("div",{className:"relative overflow-hidden rounded-xl dark:border-gray-700 p-8 shadow-sm bg-white dark:bg-gray-800 transition-all duration-300",children:(0,r.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"url",value:f,onChange:e=>v(e.target.value),placeholder:"Enter log file URL",className:"w-full rounded-full border bg-gradient-to-r from-blue-50 to-blue-100 px-4 py-3 text-sm shadow-inner transition-all duration-200  placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-300  dark:from-gray-700 dark:to-gray-800 dark:text-white dark:placeholder:text-gray-500 dark:focus:ring-blue-500"}),(0,r.jsx)(eP.A,{className:"absolute right-4 top-1/2 h-5 w-5 -translate-y-1/2 text-blue-400"})]}),(0,r.jsx)("div",{className:"w-full",children:c?(0,r.jsx)(eM,{logType:j}):o?(0,r.jsx)(eE,{progress:g,logType:j}):(0,r.jsx)("button",{type:"submit",onClick:D,className:"w-full rounded-full bg-gradient-to-r from-blue-500 to-blue-700 px-4 py-3 text-sm font-medium text-white  shadow-md transition-all duration-200 hover:from-blue-700 hover:to-blue-800 focus:outline-none  focus:ring-4 focus:ring-blue-300 dark:focus:ring-blue-500 transform hover:scale-[1.02] active:scale-[0.98]",children:"Fetch and Analyze Log"})})]})})},"url-input")})]})}function eE(e){let{progress:t,logType:a}=e,[i,n]=(0,s.useState)("Kicking off the analysis engine..."),o=["Analyzing log structure...","Extracting request patterns...","Identifying unique visitors...","Scanning for security threats...","Aggregating status codes...","Correlating traffic over time...","Building data visualizations...","Compiling the final report..."];return(0,s.useEffect)(()=>{if(100===t)return void n("Finalizing report...");let e=0,a=setInterval(()=>{e=(e+1)%(o.length-1),n(o[e])},1200);return()=>clearInterval(a)},[t]),(0,r.jsxs)(l.P.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6 relative z-10",children:[a&&(0,r.jsx)("p",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:a}),(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-3",children:[(0,r.jsx)(eT.A,{className:"h-5 w-5 animate-spin text-blue-500"}),(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:i})]}),(0,r.jsx)("div",{className:"relative h-2 w-full max-w-md mx-auto overflow-hidden rounded-full bg-gray-100 dark:bg-gray-800",children:(0,r.jsx)(l.P.div,{className:"absolute inset-y-0 left-0 bg-gradient-to-r from-blue-500 to-blue-600 dark:from-blue-400 dark:to-blue-500",initial:{width:"0%"},animate:{width:"".concat(t,"%")},transition:{duration:.3}})}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[t,"% complete"]})]})}function eq(e){let{isDragActive:t,isDragging:a}=e;return(0,r.jsxs)(l.P.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-4",children:[(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)(l.P.div,{animate:a?{y:10,scale:.95}:{y:0,scale:1},transition:{duration:.2},children:(0,r.jsx)(eR.A,{className:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500"})})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:t?"Drop your log file here":"Drop your log file here, or click to browse"}),(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-xs text-gray-500 dark:text-gray-400",children:[(0,r.jsx)(es.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Accepts .log and .txt files"})]})]})]})}function eM(e){let{logType:t}=e;return(0,r.jsxs)(l.P.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-3",children:[(0,r.jsx)(eT.A,{className:"h-5 w-5 animate-spin text-blue-500"}),(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"Determining Log Type..."})]}),t&&(0,r.jsxs)(l.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"flex items-center justify-center space-x-2",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:t}),(0,r.jsx)(S.A,{className:"h-5 w-5 text-green-500"})]})]})}var eD=a(5843),eF=a(2960),eI=a(7534),eO=a(710);function eU(e){let{wsUrl:t}=e,[l,i]=(0,s.useState)(null),[o,d]=(0,s.useState)([]),[c,x]=(0,s.useState)(!1),[g,m]=(0,s.useState)(null),[u,h]=(0,s.useState)(0),[p,b]=(0,s.useState)(new Date),[y,f]=(0,s.useState)(!1),[v,j]=(0,s.useState)("connecting"),[N,k]=(0,s.useState)(t),[w,C]=(0,s.useState)(t),[S,A]=(0,s.useState)([]),P=(0,s.useRef)(null),T=(0,s.useRef)(),R=(0,s.useRef)(null),L=(0,s.useRef)(null),E=(0,s.useRef)(Date.now()),q=(0,s.useRef)(2e3);(0,s.useRef)(null),(0,s.useEffect)(()=>{k(t),C(t)},[t]);let M=(0,s.useCallback)(e=>{A(t=>[e,...t].slice(0,100));let t=new Worker(a.tu(new URL(a.p+a.u(329),a.b)));t.onmessage=e=>{if(e.data.error)console.error("Error parsing log line:",e.data.error);else if(e.data.parsedLine){let t=e.data.parsedLine;t.attackType,d(e=>{let a=[t,...e];return i(ev(a)),a})}t.terminate()},t.onerror=e=>{console.error("Worker error:",e),t.terminate()},t.postMessage({line:e,format:"nginx"})},[]),D=(0,s.useCallback)(()=>{R.current&&clearInterval(R.current),L.current&&clearTimeout(L.current),R.current=setInterval(()=>{var e;if((null==(e=P.current)?void 0:e.readyState)===WebSocket.OPEN)try{P.current.send(JSON.stringify({type:"ping"})),L.current=setTimeout(()=>{P.current&&(console.warn("No pong received, closing connection"),P.current.close(4e3,"Pong timeout"))},1e4)}catch(e){console.error("Error sending ping:",e)}},3e4)},[]),F=(0,s.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N;if(T.current&&(clearTimeout(T.current),T.current=void 0),!e)return void m((0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"WebSocket URL is not configured."}),(0,r.jsx)("p",{className:"mt-2 font-medium",children:"Please:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[(0,r.jsx)("li",{children:"Enter a valid WebSocket URL in the input field"}),(0,r.jsx)("li",{children:"Ensure the URL starts with ws:// or wss://"}),(0,r.jsx)("li",{children:"Verify the server is accessible"})]}),(0,r.jsx)("p",{className:"mt-2 font-medium",children:"Example URLs:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[(0,r.jsx)("li",{children:"ws://localhost:8080"}),(0,r.jsx)("li",{children:"wss://your-server.com/websocket"})]})]}));try{P.current&&P.current.close(),j("connecting");let t=new WebSocket(e);P.current=t,t.onopen=()=>{P.current&&(x(!0),j("connected"),m(null),h(0),q.current=2e3,E.current=Date.now(),D(),k(e))},t.onmessage=e=>{if(P.current&&"string"==typeof e.data){E.current=Date.now();try{let t=JSON.parse(e.data);if("pong"===t.type){L.current&&(clearTimeout(L.current),L.current=null);return}}catch(t){M(e.data)}}},t.onclose=e=>{if(P.current){if(x(!1),R.current&&(clearInterval(R.current),R.current=null),L.current&&(clearTimeout(L.current),L.current=null),4001===e.code)return void F();if(1e3!==e.code&&1005!==e.code){let e=u+1;if(e<5)j("reconnecting"),h(e),q.current=Math.min(2e3*Math.pow(2,e),3e4),T.current=setTimeout(()=>{F()},q.current),m((0,r.jsx)("div",{children:(0,r.jsxs)("p",{children:["Connection lost. Reconnecting in ",q.current/1e3," seconds... (Attempt ",e+1,"/",5,")"]})}));else j("disconnected"),m((0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-medium",children:["Connection lost. Reached maximum reconnection attempts (",5,")."]}),(0,r.jsx)("p",{className:"mt-2 font-medium",children:"Please check:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[(0,r.jsx)("li",{children:"Your network connection"}),(0,r.jsx)("li",{children:"The WebSocket server URL is correct"}),(0,r.jsx)("li",{children:"The server is running and accessible"}),(0,r.jsx)("li",{children:"Firewall or proxy settings are not blocking the connection"})]}),(0,r.jsx)("p",{className:"mt-2 font-medium",children:"You can try:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[(0,r.jsx)("li",{children:"Verifying the URL and connecting again"}),(0,r.jsx)("li",{children:"Checking your network connection"}),(0,r.jsx)("li",{children:"Contacting your system administrator if the issue persists"})]})]}))}else j("disconnected"),m((0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"Connection closed by the server."}),(0,r.jsx)("p",{className:"mt-2 font-medium",children:"Possible reasons:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[(0,r.jsx)("li",{children:"Server intentionally closed the connection"}),(0,r.jsx)("li",{children:"Network interruption"}),(0,r.jsx)("li",{children:"Server maintenance or restart"})]}),(0,r.jsx)("p",{className:"mt-2 font-medium",children:"Please check:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[(0,r.jsx)("li",{children:"Your network connection"}),(0,r.jsx)("li",{children:"The WebSocket server status"}),(0,r.jsx)("li",{children:"Firewall or proxy settings"})]}),(0,r.jsx)("p",{className:"mt-2",children:"You can try reconnecting or verifying the server status."})]}))}},t.onerror=e=>{P.current&&(console.error("WebSocket error:",e),m((0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"Connection error occurred."}),(0,r.jsx)("p",{className:"mt-2 font-medium",children:"Please check:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[(0,r.jsx)("li",{children:"The WebSocket server URL is correct"}),(0,r.jsx)("li",{children:"The server is running and accessible"}),(0,r.jsx)("li",{children:"Your network connection is stable"})]}),(0,r.jsx)("p",{className:"mt-2 font-medium",children:"You can try:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[(0,r.jsx)("li",{children:"Verifying the URL and connecting again"}),(0,r.jsx)("li",{children:"Checking your network connection"}),(0,r.jsx)("li",{children:"Contacting your system administrator if the issue persists"})]})]})))}}catch(e){console.error("Failed to create WebSocket:",e),m("Failed to create WebSocket connection")}},[N,u,M,D]);(0,s.useEffect)(()=>{let e=setInterval(()=>{b(new Date)},1e3);return()=>{clearInterval(e)}},[]);let I=(0,s.useRef)(null);return(0,s.useEffect)(()=>{let e=()=>{I.current&&clearTimeout(I.current),I.current=setTimeout(()=>{"visible"===document.visibilityState&&(console.log("Tab became visible, checking connection..."),P.current&&P.current.readyState===WebSocket.OPEN?Date.now()-E.current>6e4&&(console.log("Forcing WebSocket reconnection due to inactivity..."),P.current.close(4001,"Tab became visible after inactivity")):P.current?(console.log("Forcing WebSocket reconnection..."),P.current.close(4001,"Tab became visible")):F())},1e3)};return document.addEventListener("visibilitychange",e),()=>{I.current&&clearTimeout(I.current),document.removeEventListener("visibilitychange",e)}},[F]),(0,s.useEffect)(()=>{var e;return N!==(null==(e=P.current)?void 0:e.url)&&(i(null),d([])),F(N),()=>{P.current&&(P.current.onopen=null,P.current.onmessage=null,P.current.onerror=null,P.current.onclose=null,P.current.close()),T.current&&clearTimeout(T.current),R.current&&clearInterval(R.current),L.current&&clearTimeout(L.current)}},[F,N]),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-white/80 dark:bg-gray-800/80 backdrop-blur-xl rounded-2xl border border-gray-200/50 dark:border-gray-700/50 shadow-sm p-4",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full ".concat("connected"===v?"bg-green-500 animate-pulse":"connecting"===v?"bg-yellow-500":"reconnecting"===v?"bg-orange-500 animate-pulse":"bg-red-500")}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"text-base font-semibold text-gray-900 dark:text-white truncate",children:"connected"===v?"Live Connection":"connecting"===v?"Connecting...":"reconnecting"===v?"Reconnecting...":"Disconnected"}),N&&(0,r.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[y?(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 font-mono truncate",title:N,children:N}):(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 font-mono truncate",children:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),(0,r.jsx)("button",{onClick:()=>f(!y),className:"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 focus:outline-none","aria-label":y?"Hide URL":"Show URL",children:y?(0,r.jsx)(eO.A,{className:"w-3.5 h-3.5"}):(0,r.jsx)(el.A,{className:"w-3.5 h-3.5"})})]}),"reconnecting"===v&&(0,r.jsxs)("div",{className:"text-sm text-orange-500 dark:text-orange-400 mt-1",children:["Attempt ",u+1,"/",5]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:["connected"===v||"connecting"===v||"reconnecting"===v?(0,r.jsx)("button",{onClick:()=>{P.current&&P.current.close(1e3,"User disconnected")},className:"px-3 py-1.5 bg-red-500 hover:bg-red-600 text-white text-sm rounded-lg transition-colors duration-200 font-medium",children:"Disconnect"}):(0,r.jsx)("button",{onClick:()=>{k(w),F(w)},className:"px-3 py-1.5 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-lg transition-colors duration-200 font-medium",children:"Connect"}),(0,r.jsx)("div",{className:"bg-gray-100/50 dark:bg-gray-700/50 rounded-xl px-3 py-2 min-w-[180px]",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium tracking-wide",children:p.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})}),(0,r.jsx)("div",{className:"text-lg font-bold text-gray-900 dark:text-white tracking-tight",children:p.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})})]})})]})]}),"connected"!==v&&"connecting"!==v&&"reconnecting"!==v&&(0,r.jsx)("div",{className:"mt-3 flex flex-col sm:flex-row sm:items-center gap-2",children:(0,r.jsx)("input",{type:"text",value:w,onChange:e=>C(e.target.value),placeholder:"Enter WebSocket URL",className:"flex-1 px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})})]}),g&&(0,r.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(n.A,{className:"h-5 w-5 text-red-500"})}),(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)("div",{className:"text-sm text-red-700 whitespace-pre-line",children:g})})]})}),l&&o.length>0?(0,r.jsx)(eN,{stats:l,parsedLines:o}):(0,r.jsx)("div",{className:"flex items-center justify-center h-64 bg-gray-50 dark:bg-gray-800/50 rounded-xl",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Waiting for log data..."})})})]})}var eH=a(2729);let eW=(0,a(6288).F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),eB=s.forwardRef((e,t)=>{let{className:a,variant:s,size:l,asChild:i=!1,...n}=e,o=i?eH.DX:"button";return(0,r.jsx)(o,{className:ex(eW({variant:s,size:l,className:a})),ref:t,...n})});eB.displayName="Button";let ez=s.forwardRef((e,t)=>{let{className:a,type:s,...l}=e;return(0,r.jsx)("input",{type:s,className:ex("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});function e_(){let[e,t]=(0,s.useState)(null),[a,i]=(0,s.useState)([]),[n,o]=(0,s.useState)(!1),[d,c]=(0,s.useState)(!1),[x,m]=(0,s.useState)(null),[u,h]=(0,s.useState)("");(0,s.useEffect)(()=>{let e=localStorage.getItem("darkMode");o(!!e&&JSON.parse(e)),c(!0)},[]),(0,s.useEffect)(()=>{d&&localStorage.setItem("darkMode",JSON.stringify(n))},[n,d]);let b=(0,s.useCallback)(e=>{e&&e.stats&&e.parsedLines&&(t(e.stats),i(e.parsedLines),m("upload"))},[]),y=(0,s.useCallback)(()=>{o(e=>!e)},[]),f=(0,s.useCallback)(()=>{window.location.href="/",window.location.reload()},[]),v=()=>{u&&m("live")},j={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4}}};return d?(0,r.jsx)("div",{className:n?"dark":"",children:(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 text-gray-900 dark:text-gray-100 transition-all duration-300",children:[(0,r.jsx)("nav",{className:"backdrop-blur-md bg-white/80 dark:bg-gray-900/80 border-b border-gray-200/30 dark:border-gray-700/30 sticky top-0 z-50",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(l.P.div,{variants:j,className:"flex items-center space-x-3",children:[(0,r.jsx)("img",{src:"/assets/img/analyze.jpg",alt:"HTTP Log Analyzer",className:"w-10 h-10 rounded-lg object-cover"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl lg:text-2xl font-bold",children:"HTTP Log Analyzer"}),(0,r.jsx)("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Professional Edition"})]})]}),(0,r.jsxs)(l.P.div,{variants:j,className:"flex items-center space-x-3",children:[x&&(0,r.jsxs)(eB,{onClick:f,className:"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-medium py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 flex items-center",children:[(0,r.jsx)(eD.A,{className:"w-4 h-4 mr-2"}),"New Analysis"]}),(0,r.jsx)(eC,{isDarkMode:n,toggleDarkMode:y})]})]})})}),(0,r.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,r.jsx)(l.P.div,{variants:{hidden:{opacity:0},visible:{opacity:1,transition:{duration:.6,staggerChildren:.1}}},initial:"hidden",animate:"visible",children:(0,r.jsx)(p.N,{mode:"wait",children:x?"live"===x?(0,r.jsx)(l.P.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.5},children:(0,r.jsx)(eU,{wsUrl:u})},"live-dashboard"):"upload"===x&&e?(0,r.jsx)(l.P.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.5},children:(0,r.jsx)("div",{className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-lg rounded-2xl shadow-xl border border-gray-200/50 dark:border-gray-700/50 overflow-hidden",children:(0,r.jsx)("div",{className:"p-6 sm:p-8",children:(0,r.jsx)(eN,{stats:e,parsedLines:a})})})},"upload-dashboard"):null:(0,r.jsxs)(l.P.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},exit:{opacity:0,y:-30},transition:{duration:.5},className:"max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"text-center mb-12",children:[(0,r.jsx)(l.P.h1,{variants:j,className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-gray-900 dark:text-white mb-4",children:"HTTP Log Analyzer"}),(0,r.jsx)(l.P.p,{variants:j,className:"text-lg sm:text-xl text-gray-600 dark:text-gray-300 max-w-3xl mx-auto leading-relaxed mt-4",children:"Get powerful insights from your Nginx and Apache logs via file upload or a live WebSocket stream."}),(0,r.jsxs)(l.P.div,{variants:j,className:"flex justify-center space-x-12 mt-8",children:[(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)("img",{src:"/assets/img/nginx.png",alt:"Nginx",className:"h-16 w-16 object-contain"})}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)("img",{src:"/assets/img/apache.png",alt:"Apache",className:"h-16 w-16 object-contain"})})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)(l.P.div,{variants:j,className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-lg rounded-2xl p-6 border border-gray-200/50 dark:border-gray-700/50 shadow-lg hover:shadow-xl transition-all duration-300",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/30 mr-3",children:(0,r.jsx)(eR.A,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),(0,r.jsx)("h3",{className:"text-xl font-semibold",children:"File or URL Analysis"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Upload log files or fetch them from a URL for detailed analysis."}),(0,r.jsx)(eL,{onLogParsed:b})]}),(0,r.jsxs)(l.P.div,{variants:j,className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-lg rounded-2xl p-6 border border-gray-200/50 dark:border-gray-700/50 shadow-lg hover:shadow-xl transition-all duration-300",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)("div",{className:"p-2 rounded-lg bg-green-100 dark:bg-green-900/30 mr-3",children:(0,r.jsx)(en.A,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),(0,r.jsx)("h3",{className:"text-xl font-semibold",children:"Live Monitoring"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Connect to a WebSocket stream for real-time log analysis."}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)(ez,{type:"url",placeholder:"ws://your-server:8080",value:u,onChange:e=>h(e.target.value),onKeyDown:e=>{"Enter"===e.key&&u&&v()},className:"flex-grow"}),(0,r.jsx)(eB,{onClick:v,disabled:!u,className:"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700",children:"Connect"})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:[(0,r.jsx)("p",{className:"mb-1",children:"Use the appropriate protocol for your connection:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[(0,r.jsxs)("li",{children:[(0,r.jsx)("code",{className:"bg-gray-100 dark:bg-gray-700 px-1 rounded",children:"ws://"})," (port 80) for unencrypted connections"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("code",{className:"bg-gray-100 dark:bg-gray-700 px-1 rounded",children:"wss://"})," (port 443) for secure TLS/SSL connections"]})]}),(0,r.jsx)("p",{className:"mt-1",children:"Note: WSS requires a valid SSL certificate."})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-2 text-xs text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg mt-2",children:[(0,r.jsx)(g.A,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),(0,r.jsxs)("p",{children:["Make your own custom WebSocket to stream Nginx or Apache logs. Check out ",(0,r.jsx)("a",{href:"https://github.com/aldotobing/nginx-log-streamer",target:"_blank",rel:"noopener noreferrer",className:"font-semibold underline hover:text-blue-700 dark:hover:text-blue-300",children:"nginx-log-streamer"})]})]})]})]})]})]},"selection")})})}),(0,r.jsx)("footer",{className:"border-t border-gray-200/30 dark:border-gray-700/30 mt-16 bg-white/70 dark:bg-gray-900/70 backdrop-blur-sm",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-4 md:mb-0",children:["Crafted with â¤ï¸ by ",(0,r.jsx)("a",{href:"https://aldotobing.com",target:"_blank",rel:"noopener noreferrer",className:"font-semibold text-blue-600 dark:text-blue-400 hover:underline",children:"Aldo Tobing"})]}),(0,r.jsxs)("div",{className:"flex space-x-6",children:[(0,r.jsxs)("a",{href:"https://x.com/aldo_tobing",target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",children:[(0,r.jsx)(eF.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"sr-only",children:"Twitter"})]}),(0,r.jsxs)("a",{href:"https://github.com/aldotobing",target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",children:[(0,r.jsx)(eI.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"sr-only",children:"GitHub"})]})]})]})})})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-pulse w-8 h-8 bg-blue-500 rounded-full"})})}ez.displayName="Input"},8423:(e,t,a)=>{Promise.resolve().then(a.bind(a,3603))}},e=>{e.O(0,[598,166,571,266,358],()=>e(e.s=8423)),_N_E=e.O()}]);